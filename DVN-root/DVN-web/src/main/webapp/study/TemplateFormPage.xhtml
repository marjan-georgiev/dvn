<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsp="http://java.sun.com/JSP/Page"
      xmlns:ice="http://www.icesoft.com/icefaces/component">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
  <ui:composition template="/template.xhtml">
    <ui:param name="pageTitle" value="#{bundlePageInfo.editTemplateTitle} - #{VDCRequest.dataversePageTitle}"/>
    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="templateId" value="#{TemplateFormPage.templateId}"/>
            <f:viewParam name="sourceTemplateId" value="#{TemplateFormPage.sourceTemplateId}"/>
            <f:viewParam name="studyVersionId" value="#{TemplateFormPage.studyVersionId}"/>
            <f:viewParam name="studyListingIndex" value="#{VDCRequest.studyListingIndex}"/>          
            <f:event type="preRenderView" listener="#{TemplateFormPage.preRenderView}" />
        </f:metadata>  
    </ui:define>
    <ui:define name="body">
      <f:loadBundle basename="EditStudyBundle" var="editstudybundle"/>
      <ice:form id="templateForm">
        <ice:inputHidden id="vdcId" value="#{VDCRequest.currentVDCId}"/>
        <input type="hidden" name="pageName" value="TemplateFormPage"/>
         <div class="dvn_section">
          <div class="dvn_sectionTitle">
            <ice:outputText value="#{bundlePageInfo.editTemplateTitle}"/>
          </div>
          <div class="dvn_sectionBox">
            <div panelLayout="flow" class="vdcStudyTemplateFormTable">
              <div jsfc="ice:panelGroup" styleClass="dvnInformationMessage">
                <div class="dvnMsgBlockContainer">
                  <ice:outputText value="#{bundlePageInfo.editTemplateHelp}" escape="false"/>
                </div>
              </div>
              <!-- validation errors occurred? -->
              <div id="messagePanel" class="errorMessage">
                  <ice:outputText value="Please check messages below" rendered="#{!empty facesContext.maximumSeverity}"/>
              </div>
              
              <div class="dvnStudyTemplateFormButtonsBlock">
                <div class="dvnFormMargin">
                    <ice:commandButton id="button1" value="Save" action="#{TemplateFormPage.save}"/>
                    <ice:commandButton immediate="true" id="button2" value="Cancel" action="#{TemplateFormPage.cancel}"/>
                </div>
              </div>
                
              <div class="dvnStudyTemplateTitleBlock">
                <div>
                  <ice:panelGrid cellpadding="0" cellspacing="0" columns="2" width="100%">
                      <ice:column>
                        <ice:outputText value="Template Name"/>
                      </ice:column>
                      <ice:column>
                        <ice:inputText id="template_name" size="45" value="#{TemplateFormPage.template.name}" 
                                       validator="#{TemplateFormPage.validateTemplateName}" >
                        </ice:inputText>
                        <ice:message styleClass="errorMessage" for="template_name"/>
                      </ice:column>
                  </ice:panelGrid>
                </div>
                <div>
                  <ice:panelGrid cellpadding="0" cellspacing="0" columns="2" width="100%">
                      <ice:column>
                        <ice:outputText value="Template Description"/>
                      </ice:column>
                      <ice:column>
                        <ice:inputTextarea id="template_description" size="255" value="#{TemplateFormPage.template.description}"/>
                        <ice:message styleClass="errorMessage" for="template_description"/>
                      </ice:column>
                  </ice:panelGrid>
                </div>
                <div jsfc="ice:panelGroup" rendered="#{!empty(TemplateFormPage.networkSelectItems) and VDCRequest.currentVDCId == null}">
                  <ice:panelGrid cellpadding="0" cellspacing="0" columns="2" width="100%">
                      <ice:column>
                        <ice:outputText value="Template Subnetwork"/>
                      </ice:column>
                      <ice:column>
                        <ice:selectOneMenu immediate="false" id="SelOneMenuNetwork"                                          
                              binding="#{TemplateFormPage.selectSubnetwork}"
                              rendered="#{TemplateFormPage.allowUpdateVDCNetwork}">
                                <f:selectItems value="#{TemplateFormPage.networkSelectItems}"/>
                        </ice:selectOneMenu> 
                        <ice:outputText value="#{TemplateFormPage.template.vdcNetwork.name} #{TemplateFormPage.template.vdcNetwork.id == VDCRequest.vdcNetwork.id ? 'Dataverse Network' : 'Subnetwork'}" rendered="#{!TemplateFormPage.allowUpdateVDCNetwork}"/>
                        <ice:outputText style="color:grey;font-style:italic;" value=" (Cannot be changed, default template for#{TemplateFormPage.vdcDefault and !TemplateFormPage.networkDefault ? ' one or more dataverses' : ''}#{TemplateFormPage.networkDefault and !TemplateFormPage.vdcDefault ? ' a subnetwork or dataverse network' : ''}#{TemplateFormPage.networkDefault and TemplateFormPage.vdcDefault ? ' a subnetwork or dataverse network and one or more dataverses' : ''})" rendered="#{TemplateFormPage.vdcDefault or TemplateFormPage.networkDefault}"/>
                     </ice:column>
                  </ice:panelGrid>
                </div>
              </div>
              
              <div class="vdcStudyInfoHeader">
                <ice:outputText value="Study Cataloging Information"/>
              </div>
              
              <!-- TITLE -->
              <ice:panelGrid cellpadding="0" cellspacing="0" columns="2" width="100%"
                             styleClass="vdcEditStudyTable" columnClasses="vdcEditStudyCol1, vdcEditStudyCol2">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.titleLabel}" title="#{editstudybundle.titleHelpHeading} - #{editstudybundle.titleHelp}"/>
                  <ice:graphicImage id="image39" value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.title].required}"/>
                  <ice:graphicImage id="image40" value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.title].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText binding="#{TemplateFormPage.inputTitle}" id="input_title" size="90" value="#{TemplateFormPage.template.metadata.title}"/>
                  <ice:message styleClass="errorMessage" for="input_title"/>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                    styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.subTitle].templateField.fieldInputLevelString}"
                    rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.subTitle].templateField.fieldInputLevelString != 'disabled'}"
                    columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.subtitleLabel}" title="#{editstudybundle.subtitleHelpHeading} - #{editstudybundle.subtitleHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.subTitle].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.subTitle].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_subtitle" size="90" value="#{TemplateFormPage.template.metadata.subTitle}" />
                  <ice:message styleClass="errorMessage" for="input_subtitle"/>
                </ice:column>
                <ice:column>                  
                  <ice:selectOneMenu immediate="false" partialSubmit="true"    
                                        value="#{TemplateFormPage.studyMap[sfc.subTitle].templateField.fieldInputLevelString}">
                        <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                        <f:attribute name="fieldName" value="subTitle"/>
                   </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <!-- Publications -->
              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->              
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.publication].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.publication].templateField.fieldInputLevelString}" value="dummy_datatable" >              
                    <ice:column>
                      <ice:dataTable cellpadding="0" cellspacing="0"
                                     styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                     binding="#{TemplateFormPage.dataTableRelPublications}"
                                     value="#{TemplateFormPage.template.metadata.studyRelPublications}" var="currentRow" width="100%">
                        <ice:column>
                          <div jsfc="ice:panelGroup" styleClass="vdcEditStudyField">
                            <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.relatedPublicationLabel}" title="#{editstudybundle.relatedPublicationHelpHeading} - #{editstudybundle.relatedPublicationHelp}"/>
                            <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.publication].required}"/>
                            <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.publication].recommended}"/>
                          </div>
                        </ice:column>
                        <ice:column>
                          <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloatWrap">
                              <div jsfc="ice:panelGroup">
                                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.publicationCitationLabel}" title="#{editstudybundle.relatedPublicationTextHelpHeading} - #{editstudybundle.relatedPublicationTextHelp}"/>
                                  <ice:inputTextarea cols="90" rows="4"
                                                     id="input_relatedPublicationText"
                                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.publicationCitation].templateField.controlledVocabulary)}"
                                                     binding="#{TemplateFormPage.inputRelPublicationText}"
                                                     value="#{currentRow.text}"
                                                     styleClass="formHtmlEnabled">
                                  </ice:inputTextarea>
                                  <ice:message styleClass="errorMessage" for="input_relatedPublicationText"/>
                                  <ice:selectOneMenu immediate="false"   id="SelOneMenucRelPublicationText"                                          
                                                     value="#{currentRow.text}" 
                                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.publicationCitation].templateField.controlledVocabulary)}" 
                                                     >
                                      <f:selectItem itemLabel="No Value" itemValue=""/>
                                      <f:selectItems value="#{TemplateFormPage.studyMap[sfc.publicationCitation].templateField.controlledVocabulary.selectItems}"/>
                                  </ice:selectOneMenu> 
                              </div>                                
                            <div jsfc="ice:panelGroup" styleClass="dvnFormPadding" rendered="#{TemplateFormPage.dataTableRelPublications.rowIndex==0}">
                                <ice:selectBooleanCheckbox  binding="#{TemplateFormPage.inputRelPublicationReplicationData}" value="#{currentRow.replicationData}" id="input_relatedPublicationReplicationData"/>
                                <ice:outputLabel value="Replication Data for Original Publication (This will apply &quot;Replication Data for:&quot; to your title)" for="input_relatedPublicationReplicationData"/>
                            </div>
                            <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1">
                              <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.publicationIDTypeLabel}" title="#{editstudybundle.relatedPublicationIDTypeHelpHeading} - #{editstudybundle.relatedPublicationIDTypeHelp}"/>
                              <ice:selectOneMenu  binding="#{TemplateFormPage.inputRelPublicationIDType}" id="input_relatedPublicationIDType" value="#{currentRow.idType}">
                                <f:selectItem itemLabel="Select" itemValue=""/>
                                <f:selectItem itemLabel="DOI" itemValue="DOI"/>
                                <f:selectItem itemLabel="arXiv" itemValue="ArXiv"/>
                              </ice:selectOneMenu>
                              <ice:message styleClass="errorMessage" for="input_relatedPublicationIDType"/>
                            </div>
                            <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                              <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.publicationIDNumberLabel}" title="#{editstudybundle.relatedPublicationIDNumberHelpHeading} - #{editstudybundle.relatedPublicationIDNumberHelp}"/>
                              <ice:inputText binding="#{TemplateFormPage.inputRelPublicationIDNumber}" 
                                             rendered="#{empty(TemplateFormPage.studyMap[sfc.publicationIDNumber].templateField.controlledVocabulary)}"
                                             id="input_relatedPublicationIDNumber" value="#{currentRow.idNumber}" maxlength="255"/>
                                  <ice:selectOneMenu immediate="false"   id="SelOneMenuRelPublicationIDNumber"                                          
                                                     value="#{currentRow.idNumber}" 
                                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.publicationIDNumber].templateField.controlledVocabulary)}" 
                                                     >
                                      <f:selectItem itemLabel="No Value" itemValue=""/>
                                      <f:selectItems value="#{TemplateFormPage.studyMap[sfc.publicationIDNumber].templateField.controlledVocabulary.selectItems}"/>
                                  </ice:selectOneMenu> 
                              <ice:message styleClass="errorMessage" for="input_relatedPublicationIDNumber"/>
                            </div>                            
                            <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                              <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                              value="#{editstudybundle.publicationURLLabel}" 
                                              title="#{editstudybundle.relatedPublicationURLHelpHeading} - #{editstudybundle.relatedPublicationURLHelp}"/>
                              <ice:inputText id="input_relatedPublicationURL"
                                             binding="#{TemplateFormPage.inputRelPublicationURL}"
                                             rendered="#{empty(TemplateFormPage.studyMap[sfc.publicationURL].templateField.controlledVocabulary)}"
                                             size="45"
                                             maxlength="255"
                                             value="#{currentRow.url}">
                              </ice:inputText>
                             <ice:selectOneMenu immediate="false"   id="SelOneMenuRelPublicationURL"                                          
                                                     value="#{currentRow.url}" 
                                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.publicationURL].templateField.controlledVocabulary)}" 
                                                     >
                                      <f:selectItem itemLabel="No Value" itemValue=""/>
                                      <f:selectItems value="#{TemplateFormPage.studyMap[sfc.publicationURL].templateField.controlledVocabulary.selectItems}"/>
                                  </ice:selectOneMenu> 
                              <ice:outputText styleClass="vdcEditStudyFormatExample" value="(http://example-domain.edu/)"/>
                              <ice:message styleClass="errorMessage" for="input_relatedPublicationURL"/>
                            </div>
                          </div>                            
                        </ice:column>
                        <ice:column>
                          <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                          <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableRelPublications.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}" />
                          <ice:commandLink value="Select Vocabulary" rendered ="#{TemplateFormPage.dataTableRelPublications.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.publication].templateField)}"/>
                          <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                                value="#{TemplateFormPage.studyMap[sfc.publication].templateField.fieldInputLevelString}"
                                                rendered ="#{TemplateFormPage.dataTableRelPublications.rowIndex==0}">
                                   <f:attribute name="fieldName" value="relatedPublications"/>
                                   <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                          </ice:selectOneMenu>
                        </ice:column>
                      </ice:dataTable>
                    </ice:column>                
                  </ice:dataTable>                 

              

              <div id="groupPanel9" class="vdcStudyInfoHeader">
                <ice:outputText id="outputText26" value="Citation Information"/>
              </div>

              <!-- OTHER IDS -->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.otherId].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.otherId].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableOtherIds}"
                                 value="#{TemplateFormPage.template.metadata.studyOtherIds}" var="currentRow">
                    <ice:column styleClass="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.otherIdLabel}" title="#{editstudybundle.otheridHelpHeading} - #{editstudybundle.otheridHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.otherId].templateField.fieldInputLevelString=='required'}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.otherId].templateField.fieldInputLevelString=='recommended'}"/>
                    </ice:column>
                    <ice:column >
                      <div class="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.otherIdLabel}" title="#{editstudybundle.otheridHelpHeading} - #{editstudybundle.otheridHelp}"/>
                          <ice:inputText maxlength="255" binding="#{TemplateFormPage.inputOtherId}" id="input_otherId" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.otherIdValue].templateField.controlledVocabulary)}" 
                                         value="#{currentRow.otherId}" />
                          <ice:message styleClass="errorMessage" for="input_otherId"/>
                        <ice:selectOneMenu immediate="false"   id="selectOneOtherId"                                          
                                           value="#{currentRow.otherId}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.otherIdValue].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.otherIdValue].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>  
                        
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.otherIdAgencyLabel}" title="#{editstudybundle.otherAgencyHelpHeading} - #{editstudybundle.otherAgencyHelp}"/>
                          <ice:inputText maxlength="255" binding="#{TemplateFormPage.inputOtherIdAgency}" 
                                         id="input_otherIdAgency" value="#{currentRow.agency}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.otherIdAgency].templateField.controlledVocabulary)}"
                                         />
                        <ice:selectOneMenu immediate="false"   id="selectOneOtherIdAgency"                                          
                                           value="#{currentRow.agency}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.otherIdAgency].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.otherIdAgency].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_otherIdAgency"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column id="groupPanel61">

                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableOtherIds.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary" rendered ="#{TemplateFormPage.dataTableOtherIds.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.otherId].templateField)}"/>
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                            value="#{TemplateFormPage.studyMap[sfc.otherId].templateField.fieldInputLevelString}"
                                            rendered ="#{TemplateFormPage.dataTableOtherIds.rowIndex==0}">
                               <f:attribute name="fieldName" value="otherId"/>
                               <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <!-- Authors -->
              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.author].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.author].templateField.fieldInputLevelString}" value="dummy_datatable" >
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableAuthors}"
                                 value="#{TemplateFormPage.template.metadata.studyAuthors}" var="currentAuthor">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.authorLabel}" title="#{editstudybundle.authorHelpHeading} - #{editstudybundle.authorHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.author].templateField.fieldInputLevelString=='required'}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.author].templateField.fieldInputLevelString=='recommended'}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div class="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.authorNameLabel}" title="#{editstudybundle.authorNameHelpHeading} - #{editstudybundle.authorNameHelp}"/>
                          <ice:inputText id="input_authorName"
                                         value="#{currentAuthor.name}"
                                         size="45"
                                         maxlength="255"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.authorName].templateField.controlledVocabulary)}"
                                         binding="#{TemplateFormPage.inputAuthorName}"/>

                          <ice:message styleClass="errorMessage" for="input_authorName"/>
                          <ice:selectOneMenu immediate="false"   id="selectOneAuthorName"                                          
                                           value="#{currentAuthor.name}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.authorName].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.authorName].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>  
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="(LastName, FirstName)"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.authorAffiliationLabel}" title="#{editstudybundle.authorAffiliationHelpHeading} - #{editstudybundle.authorAffiliationHelp}"/>
                          <ice:inputText id="input_authorAffiliation" size="45" maxlength="255"
                                         binding="#{TemplateFormPage.inputAuthorAffiliation}"
                                         value="#{currentAuthor.affiliation}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.authorAffiliation].templateField.controlledVocabulary)}"
                                         styleClass="formHtmlEnabled">
                          </ice:inputText>
                          <ice:message styleClass="errorMessage" for="input_authorAffiliation"/>
                          <ice:selectOneMenu immediate="false"   id="selectOneAuthorAffiliation"                                          
                                           value="#{currentAuthor.affiliation}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.authorAffiliation].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.authorAffiliation].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableAuthors.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary" rendered ="#{TemplateFormPage.dataTableAuthors.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.author].templateField)}"/>
                      <ice:selectOneMenu immediate="false"  partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.author].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableAuthors.rowIndex==0}">
                            <f:selectItems value="#{TemplateFormPage.displayAlwaysFieldInputLevelSelectItems}"/>
                            <f:attribute name="fieldName" value="authorName" />
                      </ice:selectOneMenu> 
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <!--Producers-->
              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.producer].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.producer].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableProducers}"
                                 value="#{TemplateFormPage.template.metadata.studyProducers}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">                          
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.producerLabel}" title="#{editstudybundle.producerHelpHeading} - #{editstudybundle.producerHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.producer].templateField.fieldInputLevelString=='required'}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.producer].templateField.fieldInputLevelString=='recommended'}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div class="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1 ">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.producerLabel}" title="#{editstudybundle.producerHelpHeading} - #{editstudybundle.producerHelp}"/>
                          <ice:inputText maxlength="255" binding="#{TemplateFormPage.inputProducerName}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.producerName].templateField.controlledVocabulary)}" 
                                         id="input_producerName" value="#{currentRow.name}" size="45"/>
                          <ice:selectOneMenu immediate="false"   id="selectOneProducerName"                                          
                                           value="#{currentRow.name}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.producerName].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.producerName].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_producerName"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.producerAbbreviationLabel}" title="#{editstudybundle.producerAbbreviationHelpHeading} - #{editstudybundle.producerAbbreviationHelp}"/>
                          <ice:inputText maxlength="255"  binding="#{TemplateFormPage.inputProducerAbbreviation}" 
                                          rendered="#{empty(TemplateFormPage.studyMap[sfc.producerAbbreviation].templateField.controlledVocabulary)}"
                                         id="input_producerAbbreviation" value="#{currentRow.abbreviation}" />
                           <ice:selectOneMenu immediate="false"   id="selectOneProducerAbbreviation"                                          
                                           value="#{currentRow.abbreviation}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.producerAbbreviation].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.producerAbbreviation].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_producerAbbreviation"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat3">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.producerAffiliationLabel}" title="#{editstudybundle.producerAffiliationHelpHeading} - #{editstudybundle.producerAffiliationHelp}"/>
                          <ice:inputText maxlength="255"  binding="#{TemplateFormPage.inputProducerAffiliation}" 
                                         id="input_producerAffiliation" size="45" value="#{currentRow.affiliation}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.producerAffiliation].templateField.controlledVocabulary)}" 
                                         styleClass="formHtmlEnabled">
                          </ice:inputText>
                           <ice:selectOneMenu immediate="false"   id="selectOneProducerAffiliation"                                          
                                           value="#{currentRow.affiliation}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.producerAffiliation].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.producerAffiliation].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_producerAffiliation"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.producerURLLabel}" title="#{editstudybundle.producerURLHelpHeading} - #{editstudybundle.producerURLHelp}"/>
                          <ice:inputText id="input_producerURL"
                                         binding="#{TemplateFormPage.inputProducerUrl}"
                                         value="#{currentRow.url}"
                                         size="45"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.producerURL].templateField.controlledVocabulary)}"
                                         maxlength="255">
                          </ice:inputText>
                          <ice:selectOneMenu immediate="false"   id="selectOneProducerURL"                                          
                                           value="#{currentRow.url}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.producerURL].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.producerURL].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="(http://example-domain.edu/)"/>
                          <ice:message styleClass="errorMessage" for="input_producerURL"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.producerLogoLabel}" title="#{editstudybundle.producerLogoHelpHeading} - #{editstudybundle.producerLogoHelp}"/>
                          <ice:inputText id="input_producerLogo"
                                         binding="#{TemplateFormPage.inputProducerLogo}"
                                         value="#{currentRow.logo}"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.producerLogo].templateField.controlledVocabulary)}" 
                                         size="45"
                                         maxlength="255">
                          </ice:inputText>
                          <ice:selectOneMenu immediate="false"   id="selectOneProducerLogo"                                          
                                           value="#{currentRow.logo}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.producerLogo].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.producerLogo].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="(http://example-domain.edu/image)"/>
                          <ice:message styleClass="errorMessage" for="input_producerLogo"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableProducers.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary" rendered ="#{TemplateFormPage.dataTableProducers.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.producer].templateField)}"/>
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.producer].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableProducers.rowIndex==0}">
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                            <f:attribute name="fieldName" value="producerName" />
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or TemplateFormPage.studyMap[sfc.productionDate].templateField.fieldInputLevelString != 'disabled'}"                             
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.productionDate].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.productionDateLabel}" title="#{editstudybundle.productionDateHelpHeading} - #{editstudybundle.productionDateHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.productionDate].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.productionDate].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_productionDate" styleClass="formDateFormat" value="#{TemplateFormPage.template.metadata.productionDate}">
                      </ice:inputText>
                  <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                  <ice:message styleClass="errorMessage" for="input_productionDate"><f:param name="x" value="Production Date:"/> </ice:message>
                </ice:column>
                <ice:column>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.productionDate].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="productionDate" />
                            <f:selectItems value="#{TemplateFormPage.displayAlwaysFieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or TemplateFormPage.studyMap[sfc.productionPlace].templateField.fieldInputLevelString != 'disabled'}"                               
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.productionPlace].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3" columns="3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.productionPlaceLabel}" title="#{editstudybundle.productionPlaceHelpHeading} - #{editstudybundle.productionPlaceHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.productionPlace].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.productionPlace].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_productionPlace" size="45" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.productionPlace].templateField.controlledVocabulary)}"
                                 value="#{TemplateFormPage.template.metadata.productionPlace}"/>
                        <ice:message styleClass="errorMessage" for="input_productionPlace"/>
                        <ice:selectOneMenu immediate="false"   id="selectOneProductionPlace" rendered="#{!empty(TemplateFormPage.studyMap[sfc.productionPlace].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.productionPlace}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.productionPlace].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>  
                </ice:column>  
                <ice:column>   
                  <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.productionPlace].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.productionPlace].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="productionPlace" />
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <!-- Software -->
              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.software].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.software].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableSoftware}"
                                 value="#{TemplateFormPage.template.metadata.studySoftware}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.softwareNameLabel}" title="#{editstudybundle.softwareNameHelpHeading} - #{editstudybundle.softwareNameHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.software].templateField.fieldInputLevelString=='required'}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.software].templateField.fieldInputLevelString}=='recommended'}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div class="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.softwareNameLabel}" title="#{editstudybundle.softwareNameHelpHeading} - #{editstudybundle.softwareNameHelp}"/>
                          <ice:inputText maxlength="255" binding="#{TemplateFormPage.inputSoftwareName}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.softwareName].templateField.controlledVocabulary)}" 
                                         id="input_softwareName" size="45" value="#{currentRow.name}"/>
                         <ice:selectOneMenu immediate="false"   id="selectOneSoftwareName"                                          
                                           value="#{currentRow.name}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.softwareName].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.softwareName].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_softwareName"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.softwareVersionLabel}" title="#{editstudybundle.softwareVersionHelpHeading} - #{editstudybundle.softwareVersionHelp}"/>
                          <ice:inputText maxlength="255" binding="#{TemplateFormPage.inputSoftwareVersion}"  
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.softwareVersion].templateField.controlledVocabulary)}"
                                         id="input_softwareVersion" value="#{currentRow.softwareVersion}"/>
                        <ice:selectOneMenu immediate="false"   id="selectOneSoftwareVersion"                                          
                                           value="#{currentRow.softwareVersion}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.softwareVersion].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.softwareVersion].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                          <ice:message styleClass="errorMessage" for="input_softwareVersion"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableSoftware.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary" 
                                       rendered ="#{TemplateFormPage.dataTableSoftware.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.software].templateField)}"/>
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.software].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableSoftware.rowIndex==0}">
                            <f:attribute name="fieldName" value="softwareName" />
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                            styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.fundingAgency].templateField.fieldInputLevelString}"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.fundingAgency].templateField.fieldInputLevelString != 'disabled'}"
                            columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.fundingAgencyLabel}" title="#{editstudybundle.fundingAgencyHelpHeading} - #{editstudybundle.fundingAgencyHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.fundingAgency].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.fundingAgency].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_fundingAgency" size="45" rendered="#{empty(TemplateFormPage.studyMap[sfc.fundingAgency].templateField.controlledVocabulary)}" 
                                 value="#{TemplateFormPage.template.metadata.fundingAgency}"/>
                  <ice:message styleClass="errorMessage" for="input_fundingAgency"/>
                        <ice:selectOneMenu immediate="false"   id="selectOneFundingAgency" rendered="#{!empty(TemplateFormPage.studyMap[sfc.fundingAgency].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.fundingAgency}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.fundingAgency].templateField.controlledVocabulary.selectItems}"/>
                            <f:attribute name="sf_id" value="#{TemplateFormPage.studyMap[sfc.fundingAgency].templateField.studyField.id}"/>
                        </ice:selectOneMenu> 
                </ice:column>
                <ice:column>
                  <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.fundingAgency].templateField)}"/>
                  <ice:selectOneMenu immediate="false"  partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.fundingAgency].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="fundingAgency" />
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or TemplateFormPage.studyMap[sfc.grantNumber].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.grantNumber].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableGrants}"
                                 value="#{TemplateFormPage.template.metadata.studyGrants}" var="currentRow" width="100%">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.grantNumberLabel}" title="#{editstudybundle.grantNumberHelpHeading} - #{editstudybundle.grantNumberHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.grantNumber].templateField.fieldInputLevelString=='required'}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.grantNumber].templateField.fieldInputLevelString=='recommended'}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.grantNumberLabel}" title="#{editstudybundle.grantNumberHelpHeading} - #{editstudybundle.grantNumberHelp}"/>
                          <ice:inputText maxlength="255" immediate="true" binding="#{TemplateFormPage.inputGrantNumber}" 
                                          rendered="#{empty(TemplateFormPage.studyMap[sfc.grantNumberValue].templateField.controlledVocabulary)}" 
                                         id="input_grantNumber" size="45" value="#{currentRow.number}"/>
                          <ice:message styleClass="errorMessage" for="input_grantNumber"/>
                          <ice:selectOneMenu immediate="false"   id="selectOneGrantNumber"
                                             rendered="#{!empty(TemplateFormPage.studyMap[sfc.grantNumberValue].templateField.controlledVocabulary)}"                                          
                                           value="#{currentRow.number}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.grantNumberValue].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.grantingAgencyLabel}" title="#{editstudybundle.grantingAgencyHelpHeading} - #{editstudybundle.grantingAgencyHelp}"/>
                          <ice:inputText maxlength="255" immediate="true"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.grantNumberAgency].templateField.controlledVocabulary)}"
                                         binding="#{TemplateFormPage.inputGrantAgency}"  id="input_grantNumberAgency" size="45" value="#{currentRow.agency}"/>
                         <ice:selectOneMenu immediate="false"   id="selectOneGrantAgency"
                                             rendered="#{!empty(TemplateFormPage.studyMap[sfc.grantNumberAgency].templateField.controlledVocabulary)}"                                          
                                           value="#{currentRow.agency}" >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.grantNumberAgency].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                          <ice:message styleClass="errorMessage" for="input_grantNumberAgency"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableGrants.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary" 
                                       rendered ="#{TemplateFormPage.dataTableGrants.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.grantNumber].templateField)}"/>
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.grantNumber].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableGrants.rowIndex==0}">
                            <f:attribute name="fieldName" value="grantNumber" />
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.distributor].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.distributor].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableDistributors}"
                                 value="#{TemplateFormPage.template.metadata.studyDistributors}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorLabel}" title="#{editstudybundle.distributorHelpHeading} - #{editstudybundle.distributorHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.distributor].templateField.fieldInputLevelString=='required'}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.distributor].templateField.fieldInputLevelString=='recommended'}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div styleClass="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorLabel}" title="#{editstudybundle.distributorHelpHeading} - #{editstudybundle.distributorHelp}"/>
                          <ice:inputText maxlength="255" binding="#{TemplateFormPage.inputDistributorName}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorName].templateField.controlledVocabulary)}" 
                                         id="input_distributorName" value="#{currentRow.name}" size="45"/>
                          <ice:message styleClass="errorMessage" for="input_distributorName"/>
                        </div>
                        <ice:selectOneMenu immediate="false"   id="selectOneDistributorName"                                          
                                           value="#{currentRow.name}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorName].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorName].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorAbbreviationLabel}" title="#{editstudybundle.distributorAbbreviationHelpHeading} - #{editstudybundle.distributorAbbreviationHelp}"/>
                          <ice:inputText maxlength="255"  binding="#{TemplateFormPage.inputDistributorAbbreviation}"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorAbbreviation].templateField.controlledVocabulary)}" 
                                         id="input_distributorAbbreviation" value="#{currentRow.abbreviation}"/>
                           <ice:selectOneMenu immediate="false"   id="selectOneDistributorAbbreviation"                                          
                                           value="#{currentRow.abbreviation}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorAbbreviation].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorAbbreviation].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_distributorAbbreviation"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat3 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorAffiliationLabel}" title="#{editstudybundle.distributorAffiliationHelpHeading} - #{editstudybundle.distributorAffiliationHelp}"/>
                          <ice:inputText maxlength="255" id="input_distributorAffiliation"  binding="#{TemplateFormPage.inputDistributorAffiliation}" size="45"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorAffiliation].templateField.controlledVocabulary)}"
                                         value="#{currentRow.affiliation}"
                                         styleClass="formHtmlEnabled">
                          </ice:inputText>
                          <ice:selectOneMenu immediate="false"   id="selectOneDistributorAffiliation"                                          
                                           value="#{currentRow.affiliation}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorAffiliation].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorAffiliation].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                          <ice:message styleClass="errorMessage" for="input_distributorAffiliation"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorURLLabel}" title="#{editstudybundle.distributorURLHelpHeading} - #{editstudybundle.distributorURLHelp}"/>
                          <ice:inputText id="input_distributorURL"
                                         binding="#{TemplateFormPage.inputDistributorUrl}"
                                         value="#{currentRow.url}"
                                         size="45"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorURL].templateField.controlledVocabulary)}" 
                                         maxlength="255">
                          </ice:inputText>
                          <ice:selectOneMenu immediate="false"   id="selectOneDistributorUrl"                                          
                                           value="#{currentRow.url}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorURL].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorURL].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="(http://example-domain.edu/)"/>
                          <ice:message styleClass="errorMessage" for="input_distributorURL"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorLogoLabel}" title="#{editstudybundle.distributorLogoHelpHeading} - #{editstudybundle.distributorLogoHelp}"/>
                          <ice:inputText binding="#{TemplateFormPage.inputDistributorLogo}" id="input_distributorLogo"
                                         value="#{currentRow.logo}"
                                         size="45"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorLogo].templateField.controlledVocabulary)}" 
                                         maxlength="255">
                          </ice:inputText>
                         <ice:selectOneMenu immediate="false"   id="selectOneDistributorlogo"                                          
                                           value="#{currentRow.logo}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorLogo].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorLogo].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="(http://example-domain.edu/image)"/>
                          <ice:message styleClass="errorMessage" for="input_distributorLogo"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableDistributors.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary" rendered ="#{TemplateFormPage.dataTableDistributors.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.distributor].templateField)}"/>
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.distributor].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableDistributors.rowIndex==0}">
                            <f:attribute name="fieldName" value="distributorName" />
                            <f:selectItems value="#{TemplateFormPage.displayAlwaysFieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.distributorContact].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.distributorContact].templateField.fieldInputLevelString}" columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorContactLabel}" title="#{editstudybundle.distributorContactHelpHeading} - #{editstudybundle.distributorContactHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.distributorContact].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.distributorContact].recommended}"/>
                </ice:column>
                <ice:column styleClass="vdcEditStudyFieldFloatWrap">
                  <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1">
                    <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorContactLabel}" title="#{editstudybundle.distributorContactHelpHeading} - #{editstudybundle.distributorContactHelp}"/>
                    <ice:inputText binding ="#{TemplateFormPage.inputDistributorContact}" 
                                   id="input_distributorContact" size="45" 
                                   rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorContactName].templateField.controlledVocabulary)}"
                                   value="#{TemplateFormPage.template.metadata.distributorContact}"  />
                        <ice:selectOneMenu immediate="false"   id="selectOneDistributorContact"                                          
                                           value="#{TemplateFormPage.template.metadata.distributorContact}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorContactName].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorContactName].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                    <ice:message styleClass="errorMessage" for="input_distributorContact"/>
                  </div>
                  <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                    <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorContactAffiliationLabel}" title="#{editstudybundle.distributorContactAffiliationHelpHeading} - #{editstudybundle.distributorContactAffiliationHelp}"/>
                    <ice:inputText id="distributorContactAffiliation"
                                   binding ="#{TemplateFormPage.inputDistributorContactAffiliation}"
                                   rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorContactAffiliation].templateField.controlledVocabulary)}" 
                                  value="#{TemplateFormPage.template.metadata.distributorContactAffiliation}"
                                   styleClass="formHtmlEnabled">
                    </ice:inputText>
                    <ice:selectOneMenu immediate="false"   id="selectOneDistributorContactAffiliation"                                          
                                           value="#{TemplateFormPage.template.metadata.distributorContactAffiliation}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorContactAffiliation].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorContactAffiliation].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                    <ice:message styleClass="errorMessage" for="distributorContactAffiliation"/>
                    <ice:message styleClass="errorMessage" for="selectOneDistributorContactAffiliation"/>
                  </div>
                  <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat3 vdcEditStudyGroupField">
                    <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributorContactEmailLabel}" title="#{editstudybundle.distributorContactEmailHelpHeading} - #{editstudybundle.distributorContactEmailHelp}"/>
                    <ice:inputText binding ="#{TemplateFormPage.inputDistributorContactEmail}" id="input_distributorContactEmail" size="45" 
                                   rendered="#{empty(TemplateFormPage.studyMap[sfc.distributorContactEmail].templateField.controlledVocabulary)}"
                                   value="#{TemplateFormPage.template.metadata.distributorContactEmail}"/>
                       <ice:selectOneMenu immediate="false"   id="selectOneDistributorContactEmail"                                          
                                           value="#{TemplateFormPage.template.metadata.distributorContactEmail}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.distributorContactEmail].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.distributorContactEmail].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                    <ice:message styleClass="errorMessage" for="input_distributorContactEmail"/>
                  </div>
                </ice:column>
                <ice:column>
                   <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.distributorContact].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.distributorContact].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="distributorContact" />
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.distributionDate].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.distributionDate].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column id="groupPanel49" styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.distributionDateLabel}" title="#{editstudybundle.distributionDateHelpHeading} - #{editstudybundle.distributionDateHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.distributionDate].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.distributionDate].recommended}"/>
                </ice:column>
                <ice:column id="groupPanel26" styleClass="#{TemplateFormPage.studyMap[sfc.distributionDate].templateField.fieldInputLevelString}">
                  <ice:inputText id="input_distributionDate" styleClass="formDateFormat" value="#{TemplateFormPage.template.metadata.distributionDate}">
                </ice:inputText>

                  <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                  <ice:message styleClass="errorMessage" for="input_distributionDate"/>
                </ice:column>
                <ice:column>
                    <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.distributionDate].templateField.fieldInputLevelString}">
                           <f:attribute name="fieldName" value="distributionDate" />
                           <f:selectItems value="#{TemplateFormPage.displayAlwaysFieldInputLevelSelectItems}"/>
                    </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.depositor].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.depositor].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.depositorLabel}" title="#{editstudybundle.depositorHelpHeading} - #{editstudybundle.depositorHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.depositor].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.depositor].recommended}"/>
                </ice:column>
                <ice:column styleClass="#{TemplateFormPage.studyMap[sfc.depositor].templateField.fieldInputLevelString}">
                  <ice:inputText id="input_depositor" size="45" rendered="#{empty(TemplateFormPage.studyMap[sfc.depositor].templateField.controlledVocabulary)}"
                                 value="#{TemplateFormPage.template.metadata.depositor}" />
                  <ice:message styleClass="errorMessage" for="input_depositor"/>
                  <ice:selectOneMenu immediate="false"   id="selectOneDepositor" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.depositor].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.depositor}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.depositor].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.depositor].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.depositor].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="depositor" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.dateOfDeposit].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.dateOfDeposit].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.depositDateLabel}" title="#{editstudybundle.depositDateHelpHeading} - #{editstudybundle.depositDateHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.dateOfDeposit].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.dateOfDeposit].recommended}"/>
                </ice:column>
                <ice:column styleClass="vdcEditStudyField #{TemplateFormPage.studyMap[sfc.dateOfDeposit].templateField.fieldInputLevelString}">
                  <ice:graphicImage value="/resources/images/icon_warning.18.png" styleClass="dvn_icon"/>
                  <ice:outputText styleClass="vdcHelpText" value=" #{editstudybundle.depositDateLabel} cannot be set in a template."/>
                  <ice:message styleClass="errorMessage" for="input_dateOfDeposit"/>
                </ice:column>
                <ice:column>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.dateOfDeposit].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="dateOfDeposit" />
                           <f:selectItems value="#{TemplateFormPage.displayAlwaysFieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.series].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.series].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.seriesLabel}" title="#{editstudybundle.seriesHelpHeading} - #{editstudybundle.seriesHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.series].templateField.fieldInputLevelString=='required'}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.series].templateField.fieldInputLevelString=='recommended'}"/>
                </ice:column>
                <ice:column>
                  <div jsfc="ice:panelGroup" id="groupPanel29" styleClass="vdcEditStudyField">
                    <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.seriesLabel}" title="#{editstudybundle.seriesHelpHeading} - #{editstudybundle.seriesHelp}"/>
                    <ice:inputText binding="#{TemplateFormPage.inputSeries}" id="input_seriesName"
                                   value="#{TemplateFormPage.template.metadata.seriesName}"
                                   rendered="#{empty(TemplateFormPage.studyMap[sfc.seriesName].templateField.controlledVocabulary)}"
                                   styleClass="formHtmlEnabled">
                    </ice:inputText>
                     <ice:selectOneMenu immediate="false"   id="selectOneSeriesName"                                          
                                           value="#{TemplateFormPage.template.metadata.seriesName}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.seriesName].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.seriesName].templateField.controlledVocabulary.selectItems}"/>
                     </ice:selectOneMenu>                    
                    <ice:message styleClass="errorMessage" for="input_seriesName"/>
                  </div>
                  <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField" >
                    <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.seriesInformationLabel}" title="#{editstudybundle.seriesInformationHelpHeading} - #{editstudybundle.seriesInformationHelp}"/>
                    <ice:inputText binding ="#{TemplateFormPage.inputSeriesInformation}" id="input_seriesInformation"
                                   size="45"
                                   rendered="#{empty(TemplateFormPage.studyMap[sfc.seriesInformation].templateField.controlledVocabulary)}"
                                   value="#{TemplateFormPage.template.metadata.seriesInformation}"
                                   styleClass="formHtmlEnabled">
                    </ice:inputText>
                    <ice:selectOneMenu immediate="false"   id="selectOneSeriesInformation"                                          
                                           value="#{TemplateFormPage.template.metadata.seriesInformation}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.seriesInformation].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.seriesInformation].templateField.controlledVocabulary.selectItems}"/>
                     </ice:selectOneMenu> 
                    <ice:message styleClass="errorMessage" for="input_seriesInformation"/>
                  </div>
                </ice:column>
                <ice:column>
                  <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.series].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.series].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="seriesName" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.studyVersion].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.studyVersion].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.seriesVersionLabel}" title="#{editstudybundle.seriesVersionHelpHeading} - #{editstudybundle.seriesVersionHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.studyVersion].templateField.fieldInputLevelString =='required'}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.studyVersion].templateField.fieldInputLevelString =='recommended'}"/>
                </ice:column>
                <ice:column>
                  <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                    <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.seriesVersionLabel}" title="#{editstudybundle.seriesVersionHelpHeading} - #{editstudybundle.seriesVersionHelp}"/>
                    <ice:inputText binding="#{TemplateFormPage.inputVersion}" id="input_studyVersion" 
                                   rendered="#{empty(TemplateFormPage.studyMap[sfc.studyVersionValue].templateField.controlledVocabulary)}" 
                                   value="#{TemplateFormPage.template.metadata.studyVersionText}"/>
                     <ice:selectOneMenu immediate="false"   id="selectOneStudyVersionText"                                          
                                           value="#{TemplateFormPage.template.metadata.studyVersionText}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.studyVersionValue].templateField.controlledVocabulary)}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.studyVersionValue].templateField.controlledVocabulary.selectItems}"/>
                     </ice:selectOneMenu> 
                    <ice:message styleClass="errorMessage" for="input_studyVersion"/>
                  </div>
                  <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                    <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.seriesVersionDateLabel}" title="#{editstudybundle.seriesVersionDateHelpHeading} - #{editstudybundle.seriesVersionDateHelp}"/>
                    <ice:inputText binding="#{TemplateFormPage.inputVersionDate}"
                                   rendered="#{empty(TemplateFormPage.studyMap[sfc.versionDate].templateField.controlledVocabulary)}"
                                   id="input_versionDate" styleClass="formDateFormat" value="#{TemplateFormPage.template.metadata.versionDate}">
                        </ice:inputText>
                     <ice:selectOneMenu immediate="false"   id="selectOneVersionDate"                                          
                                           value="#{TemplateFormPage.template.metadata.versionDate}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.versionDate].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.versionDate].templateField.controlledVocabulary.selectItems}"/>
                     </ice:selectOneMenu> 

                    <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                    <ice:message styleClass="errorMessage" for="input_versionDate"/>
                  </div>
                </ice:column>
                <ice:column>
                  <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.studyVersion].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.studyVersion].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="studyVersion" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>
              

              <div jsfc="ice:panelGroup" id="groupPanel12" styleClass="vdcStudyInfoHeader #{TemplateFormPage.abstractAndScopeInputLevel}">
                <ice:outputText id="outputText65" value="Description and Scope"/>
              </div>

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.description].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.description].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableAbstracts}"
                                 value="#{TemplateFormPage.template.metadata.studyAbstracts}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.abstractLabel}" title="#{editstudybundle.abstractHelpHeading} - #{editstudybundle.abstractHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.description].templateField.fieldInputLevelString=='required'}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.description].templateField.fieldInputLevelString=='recommended'}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div>
                        <div>
                          <p>
                              <ice:graphicImage value="/resources/images/icon_warning.18.png" styleClass="dvn_icon"/>
                              <ice:outputText styleClass="vdcHelpText" value=" Copying and pasting from a Word document can create errors when you save this page."/>
                          </p>
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.abstractLabel}" title="#{editstudybundle.abstractHelpHeading} - #{editstudybundle.abstractHelp}"/>
                          <ice:inputTextarea cols="90" rows="12"
                                             id="input_abstractText"
                                             binding="#{TemplateFormPage.inputAbstractText}"
                                             rendered="#{empty(TemplateFormPage.studyMap[sfc.descriptionText].templateField.controlledVocabulary)}"
                                             value="#{currentRow.text}"
                                             styleClass="formHtmlEnabled">
                          </ice:inputTextarea>
                         <ice:selectOneMenu immediate="false"   id="selectOneDescriptionText"                                          
                                           value="#{currentRow.text}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.descriptionText].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.descriptionText].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_abstractText"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.abstractDateLabel}" title="#{editstudybundle.abstractDateHelpHeading} - #{editstudybundle.abstractDateHelp}"/>
                          <ice:inputText binding="#{TemplateFormPage.inputAbstractDate}" 
                                          rendered="#{empty(TemplateFormPage.studyMap[sfc.descriptionDate].templateField.controlledVocabulary)}"
                                         id="input_abstractDate" styleClass="formDateFormat" value="#{currentRow.date}">
                              </ice:inputText>
                            <ice:selectOneMenu immediate="false"   id="selectOneDescriptionDate"                                          
                                           value="#{currentRow.date}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.descriptionDate].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.descriptionDate].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                          <ice:message styleClass="errorMessage" for="input_abstractDate"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableAbstracts.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                     <ice:commandLink value="Select Vocabulary"
                                       rendered ="#{TemplateFormPage.dataTableAbstracts.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.description].templateField)}"/>
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.description].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableAbstracts.rowIndex==0}">
                            <f:attribute name="fieldName" value="abstractText" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.keyword].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.keyword].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableKeywords}"
                                 value="#{TemplateFormPage.template.metadata.studyKeywords}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.keywordLabel}" title="#{editstudybundle.keywordHelpHeading} - #{editstudybundle.keywordHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.keyword].required}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.keyword].recommended}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div class="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.keywordLabel}" title="#{editstudybundle.keywordHelpHeading} - #{editstudybundle.keywordHelp}"/>
                          <ice:inputText binding="#{TemplateFormPage.inputKeywordValue}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.keywordValue].templateField.controlledVocabulary)}"
                                         id="input_keywordValue" value="#{currentRow.value}"/>
                          <ice:selectOneMenu immediate="false"   id="selectOneKeywordValue"                                          
                                           value="#{currentRow.value}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.keywordValue].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.keywordValue].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_keywordValue"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.keywordVocabularyLabel}" title="#{editstudybundle.keywordVocabularyHelpHeading} - #{editstudybundle.keywordVocabularyHelp}"/>
                          <ice:inputText  binding="#{TemplateFormPage.inputKeywordVocab}" id="input_keywordVocab" value="#{currentRow.vocab}"
                                           rendered="#{empty(TemplateFormPage.studyMap[sfc.keywordVocab].templateField.controlledVocabulary)}"/>
                          <ice:selectOneMenu immediate="false"   id="selectOneKeywordVocab"                                          
                                           value="#{currentRow.vocab}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.keywordVocab].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.keywordVocab].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_keywordVocab"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat3 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.keywordVocabularyURLLabel}" title="#{editstudybundle.keywordVocabularyURLHelpHeading} - #{editstudybundle.keywordVocabularyURLHelp}"/>
                          <ice:inputText id="input_keywordVocabURI"
                                         binding="#{TemplateFormPage.inputKeywordVocabUri}"
                                         size="45"
                                         maxlength="255"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.keywordVocabURI].templateField.controlledVocabulary)}"
                                         value="#{currentRow.vocabURI}">
                          </ice:inputText>
                          <ice:selectOneMenu immediate="false"   id="selectOneKeywordVocabURI"                                          
                                           value="#{currentRow.vocabURI}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.keywordVocabURI].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.keywordVocabURI].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="(http://example-domain.edu/)"/>
                          <ice:message styleClass="errorMessage" for="input_keywordVocabURI"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableKeywords.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary"
                                       rendered ="#{TemplateFormPage.dataTableKeywords.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.keyword].templateField)}"/>
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.keyword].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableKeywords.rowIndex==0}">
                            <f:attribute name="fieldName" value="keywordValue" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.topicClassification].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable" rowClasses="#{TemplateFormPage.studyMap[sfc.topicClassification].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 id="dataTableTopicClass"
                                 binding="#{TemplateFormPage.dataTableTopicClass}"
                                 value="#{TemplateFormPage.template.metadata.studyTopicClasses}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.topicClassificationLabel}" title="#{editstudybundle.topicClassificationHelpHeading} - #{editstudybundle.topicClassificationHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.topicClassification].required}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.topicClassification].recommended}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div class="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.topicClassificationLabel}" title="#{editstudybundle.topicClassificationHelpHeading} - #{editstudybundle.topicClassificationHelp}"/>
                          <ice:inputText binding="#{TemplateFormPage.inputTopicClassValue}" 
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.topicClassValue].templateField.controlledVocabulary)}"
                                         id="input_topicClassValue" value="#{currentRow.value}"/>
                            <ice:selectOneMenu immediate="false"   id="selectOneTopicClassValue"                                          
                                           value="#{currentRow.value}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.topicClassValue].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.topicClassValue].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_topicClassValue"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.topicClassVocabularyLabel}" title="#{editstudybundle.topicClassVocabularyHelpHeading} - #{editstudybundle.topicClassVocabularyHelp}"/>
                          <ice:inputText maxlength="255"  
                                         binding="#{TemplateFormPage.inputTopicClassVocab}"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.topicClassVocab].templateField.controlledVocabulary)}"
                                         id="input_topicClassVocab" value="#{currentRow.vocab}" />
                          <ice:selectOneMenu immediate="false"   id="selectOneTopicClassVocab"                                          
                                           value="#{currentRow.vocab}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.topicClassVocab].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.topicClassVocab].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_topicClassVocab"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat3 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.topicClassVocabularyURLLabel}" title="#{editstudybundle.topicClassVocabularyURLHelpHeading} - #{editstudybundle.topicClassVocabularyURLHelp}"/>
                          <ice:inputText id="input_topicClassVocabURI"
                                         binding="#{TemplateFormPage.inputTopicClassVocabUri}"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.topicClassVocabURI].templateField.controlledVocabulary)}"
                                         size="45"
                                         maxlength="255"
                                         value="#{currentRow.vocabURI}">
                          </ice:inputText>
                          <ice:selectOneMenu immediate="false"   id="selectOnetopicClassVocabURI"                                          
                                           value="#{currentRow.vocabURI}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.topicClassVocabURI].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.topicClassVocabURI].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:outputText styleClass="vdcEditStudyFormatExample" value="(http://example-domain.edu/)"/>
                          <ice:message styleClass="errorMessage" for="input_topicClassVocabURI"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableTopicClass.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary"
                                       rendered ="#{TemplateFormPage.dataTableTopicClass.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.topicClassification].templateField)}"/>                     
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.topicClassification].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableTopicClass.rowIndex==0}">
                            <f:attribute name="fieldName" value="topicClassValue" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

<!--Removed related publications re-add in new format above-->

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                             styleClass="vdcEditStudyTable"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.relatedMaterial].templateField.fieldInputLevelString != 'disabled'}"
                             rowClasses="#{TemplateFormPage.studyMap[sfc.relatedMaterial].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableRelMaterials}"
                                 value="#{TemplateFormPage.template.metadata.studyRelMaterials}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.relatedMaterialLabel}" title="#{editstudybundle.relatedMaterialHelpHeading} - #{editstudybundle.relatedMaterialHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.relatedMaterial].required}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.relatedMaterial].recommended}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div>
                        <ice:inputTextarea cols="90" rows="4"
                                           id="input_relatedMaterial"
                                           binding="#{TemplateFormPage.inputRelMaterial}"
                                           rendered="#{empty(TemplateFormPage.studyMap[sfc.relatedMaterial].templateField.controlledVocabulary)}"
                                           value="#{currentRow.text}"
                                           styleClass="formHtmlEnabled">
                        </ice:inputTextarea>
                        <ice:selectOneMenu immediate="false"   id="selectOneRelMaterial"                                          
                                           value="#{currentRow.text}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.relatedMaterial].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.relatedMaterial].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                        <ice:message styleClass="errorMessage" for="input_relatedMaterial"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableRelMaterials.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                       <ice:commandLink value="Select Vocabulary"
                                       rendered ="#{TemplateFormPage.dataTableRelMaterials.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.relatedMaterial].templateField)}"/> 
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.relatedMaterial].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableRelMaterials.rowIndex==0}">
                            <f:attribute name="fieldName" value="relatedMaterial" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                             styleClass="vdcEditStudyTable"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.relatedStudies].templateField.fieldInputLevelString != 'disabled'}"
                             rowClasses="#{TemplateFormPage.studyMap[sfc.relatedStudies].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableRelStudies}"
                                 value="#{TemplateFormPage.template.metadata.studyRelStudies}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.relatedStudiesLabel}" title="#{editstudybundle.relatedStudiesHelpHeading} - #{editstudybundle.relatedStudiesHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.relatedStudies].required}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.relatedStudies].recommended}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div>
                        <ice:inputTextarea cols="90" rows="4"
                                           id="input_relatedStudies"
                                           binding="#{TemplateFormPage.inputRelStudy}"
                                           rendered="#{empty(TemplateFormPage.studyMap[sfc.relatedStudies].templateField.controlledVocabulary)}"
                                           value="#{currentRow.text}"
                                           styleClass="formHtmlEnabled">
                        </ice:inputTextarea>
                        <ice:selectOneMenu immediate="false"   id="selectOneRelStudy"                                          
                                           value="#{currentRow.text}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.relatedStudies].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.relatedStudies].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                        <ice:message styleClass="errorMessage" for="input_relatedStudies"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableRelStudies.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary"
                                       rendered ="#{TemplateFormPage.dataTableRelStudies.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.relatedStudies].templateField)}"/> 
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.relatedStudies].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableRelStudies.rowIndex==0}">
                            <f:attribute name="fieldName" value="relatedStudies" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                             styleClass="vdcEditStudyTable"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.otherReferences].templateField.fieldInputLevelString != 'disabled'}"
                             rowClasses="#{TemplateFormPage.studyMap[sfc.otherReferences].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                                 columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableOtherReferences}"
                                 value="#{TemplateFormPage.template.metadata.studyOtherRefs}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.otherReferencesLabel}" title="#{editstudybundle.otherReferencesHelpHeading} - #{editstudybundle.otherReferencesHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.otherReferences].required}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.otherReferences].recommended}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div>
                        <ice:inputText id="input_otherReferences"
                                       binding="#{TemplateFormPage.inputOtherReference}"
                                       rendered="#{empty(TemplateFormPage.studyMap[sfc.otherReferences].templateField.controlledVocabulary)}"
                                       value="#{currentRow.text}"
                                       size="90"
                                       styleClass="formHtmlEnabled">
                        </ice:inputText>
                        <ice:selectOneMenu immediate="false"   id="selectOneOtherRef"                                          
                                           value="#{currentRow.text}" 
                                           rendered="#{!empty(TemplateFormPage.studyMap[sfc.otherReferences].templateField.controlledVocabulary)}"
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.otherReferences].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                        <ice:message styleClass="errorMessage" for="input_otherReferences"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableOtherReferences.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary"
                                       rendered ="#{TemplateFormPage.dataTableOtherReferences.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.otherReferences].templateField)}"/> 
                      <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.otherReferences].templateField.fieldInputLevelString}"
                                        rendered ="#{TemplateFormPage.dataTableOtherReferences.rowIndex==0}">
                            <f:attribute name="fieldName" value="otherReferences" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.timePeriodStartLabel}" title="#{editstudybundle.timePeriodStartHelpHeading} - #{editstudybundle.timePeriodStartHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_timePeriodCoveredStart" styleClass="formDateFormat" value="#{TemplateFormPage.template.metadata.timePeriodCoveredStart}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].templateField.controlledVocabulary)}"/>
                  <ice:message styleClass="errorMessage" for="input_timePeriodCoveredStart"/>
                  <ice:selectOneMenu immediate="false"   id="selectTimePeriodCoveredStart" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.timePeriodCoveredStart}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>
                 <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                </ice:column>
                <ice:column>
                    <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredStart].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="timePeriodCoveredStart" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.timePeriodEndLabel}" title="#{editstudybundle.timePeriodEndHelpHeading} - #{editstudybundle.timePeriodEndHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_timePeriodCoveredEnd" styleClass="formDateFormat" value="#{TemplateFormPage.template.metadata.timePeriodCoveredEnd}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].templateField.controlledVocabulary)}"/>
                  <ice:message styleClass="errorMessage" for="input_timePeriodCoveredStart"/>
                  <ice:selectOneMenu immediate="false"   id="selectTimePeriodCoveredEnd" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.timePeriodCoveredEnd}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>
                  <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                  <ice:message styleClass="errorMessage" for="input_timePeriodCoveredEnd"/>
                </ice:column>
                <ice:column>
                  <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.timePeriodCoveredEnd].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="timePeriodCoveredEnd" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                              rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.dateOfCollectionStart].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.dateOfCollectionStart].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.collectionDateStartLabel}" title="#{editstudybundle.collectionDateStartHelpHeading} - #{editstudybundle.collectionDateStartHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.dateOfCollectionStart].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.dateOfCollectionStart].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_dateOfCollectionStart" styleClass="formDateFormat" value="#{TemplateFormPage.template.metadata.dateOfCollectionStart}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.dateOfCollectionStart].templateField.controlledVocabulary)}"/>
                  <ice:message styleClass="errorMessage" for="input_dateOfCollectionStart"/>
                  <ice:selectOneMenu immediate="false"   id="selectdateOfCollectionStart" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.dateOfCollectionStart].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.dateOfCollectionStart}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.dateOfCollectionStart].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>
                  <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                  <ice:message styleClass="errorMessage" for="input_dateOfCollectionStart"/>
                </ice:column>
                <ice:column>
                  <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.dateOfCollectionStart].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.dateOfCollectionStart].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="dateOfCollectionStart" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.collectionDateEndLabel}" title="#{editstudybundle.collectionDateEndHelpHeading} - #{editstudybundle.collectionDateEndHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_timePerioddateOfCollectionEnd" styleClass="formDateFormat" value="#{TemplateFormPage.template.metadata.dateOfCollectionEnd}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].templateField.controlledVocabulary)}"/>
                  <ice:message styleClass="errorMessage" for="input_timePerioddateOfCollectionEnd"/>
                  <ice:selectOneMenu immediate="false"   id="selectdateOfCollectionEnd" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.dateOfCollectionEnd}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>
                  <ice:outputText styleClass="vdcEditStudyFormatExample" value="#{editstudybundle.dateFormatDescription}"/>
                  <ice:message styleClass="errorMessage" for="input_dateOfCollectionEnd"/>
                </ice:column>
                <ice:column>
                  <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.dateOfCollectionEnd].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="dateOfCollectionEnd" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.country].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.country].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.countryLabel}" title="#{editstudybundle.countryHelpHeading} - #{editstudybundle.countryHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.country].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.country].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_country" size="45" value="#{TemplateFormPage.template.metadata.country}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.country].templateField.controlledVocabulary)}"/>
                  <ice:message styleClass="errorMessage" for="input_country"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneCountry" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.country].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.country}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.country].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.country].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.country].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="country" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.geographicCoverage].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.geographicCoverage].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.geographicCoverageLabel}" title="#{editstudybundle.geographicCoverageHelpHeading} - #{editstudybundle.geographicCoverageHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.geographicCoverage].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.geographicCoverage].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_geographicCoverage" size="45"
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.geographicCoverage].templateField.controlledVocabulary)}" 
                                 value="#{TemplateFormPage.template.metadata.geographicCoverage}" />
                  <ice:message styleClass="errorMessage" for="input_geographicCoverage"/>
                  <ice:selectOneMenu immediate="false"   id="selectOneGeographicCoverage" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.geographicCoverage].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.geographicCoverage}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.geographicCoverage].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.geographicCoverage].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.geographicCoverage].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="geographicCoverage" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.geographicUnit].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.geographicUnit].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.geographicUnitLabel}" title="#{editstudybundle.geographicUnitHelpHeading} - #{editstudybundle.geographicUnitHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.geographicUnit].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.geographicUnit].recommended}"/>
                </ice:column>
                <ice:column>
                  <ice:inputText id="input_geographicUnit" size="45"
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.geographicUnit].templateField.controlledVocabulary)}"
                                 value="#{TemplateFormPage.template.metadata.geographicUnit}" />
                  <ice:message styleClass="errorMessage" for="input_geographicUnit"/>
                  <ice:selectOneMenu immediate="false"   id="selectOneGeographicUnit" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.geographicUnit].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.geographicUnit}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.geographicUnit].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary" 
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.geographicUnit].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.geographicUnit].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="geographicUnit" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.geographicBoundingBox].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.geographicBoundingBox].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.geographicBoundingBoxLabel}" title="#{editstudybundle.geographicBoundingBoxHelpHeading} - #{editstudybundle.geographicBoundingBoxHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.geographicBoundingBox].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.geographicBoundingBox].recommended}"/>
                </ice:column>
                <ice:column>
                  <p>
                      <ice:graphicImage value="/resources/images/icon_info.gif" styleClass="dvn_icon"/>
                      <ice:outputText styleClass="vdcHelpText" value=" Use the "/>
                      <ice:outputLink styleClass="dvnCGAmapLink" value="#" onclick="window.open('http://maps.cga.harvard.edu/samples/gpf.htm','popup','width=700,height=700,toolbar=no,directories=no,menubar=no,status=no'); return false">
                        <ice:outputText value="CGA Geo-location Finder"/>
                      </ice:outputLink>
                      <ice:outputText styleClass="vdcHelpText" value=" to find the coordinates."/>
                  </p>
                  <div class="vdcEditStudyFieldFloatWrap">
                      <div class="vdcEditStudyFieldFloat1 vdcEditStudyGroupField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.westLongitudeLabel}" title="#{editstudybundle.westLongitudeHelpHeading} - #{editstudybundle.westLongitudeHelp}"/>
                        <ice:inputText id="input_westLongitude" binding="#{TemplateFormPage.inputWestLongitude}" value="#{TemplateFormPage.template.metadata.studyGeoBoundings[0].westLongitude}"/>
                        <ice:message styleClass="errorMessage" for="input_westLongitude"/>
                      </div>
                      <div class="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.eastLongitudeLabel}" title="#{editstudybundle.eastLongitudeHelpHeading} - #{editstudybundle.eastLongitudeHelp}"/>
                        <ice:inputText binding="#{TemplateFormPage.inputEastLongitude}" id="input_eastLongitude" value="#{TemplateFormPage.template.metadata.studyGeoBoundings[0].eastLongitude}"/>
                        <ice:message styleClass="errorMessage" for="input_eastLongitude"/>
                      </div>
                      <div class="vdcEditStudyFieldFloat1 vdcEditStudyFieldFloat3 vdcEditStudyGroupField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.northLatitudeLabel}" title="#{editstudybundle.northLatitudeHelpHeading} - #{editstudybundle.northLatitudeHelp}"/>
                        <ice:inputText binding="#{TemplateFormPage.inputNorthLatitude}" id="input_northLatitude" value="#{TemplateFormPage.template.metadata.studyGeoBoundings[0].northLatitude}"/>
                        <ice:message styleClass="errorMessage" for="input_northLatitude"/>
                      </div>
                      <div class="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.southLatitudeLabel}" title="#{editstudybundle.southLatitudeHelpHeading} - #{editstudybundle.southLatitudeHelp}"/>
                        <ice:inputText binding="#{TemplateFormPage.inputSouthLatitude}" id="input_southLatitude" value="#{TemplateFormPage.template.metadata.studyGeoBoundings[0].southLatitude}"/>
                        <ice:message styleClass="errorMessage" for="input_southLatitude"/>
                      </div>
                  </div>
                </ice:column>
                <ice:column>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.geographicBoundingBox].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="westLongitude" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.unitOfAnalysis].templateField.fieldInputLevelString != 'disabled'}"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.unitOfAnalysis].templateField.fieldInputLevelString}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.unitOfAnalysisLabel}" title="#{editstudybundle.unitOfAnalysisHelpHeading} - #{editstudybundle.unitOfAnalysisHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.unitOfAnalysis].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.unitOfAnalysis].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_unitOfAnalysis"
                                     value="#{TemplateFormPage.template.metadata.unitOfAnalysis}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.unitOfAnalysis].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_unitOfAnalysis"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneUnitOfAnalysis" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.unitOfAnalysis].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.unitOfAnalysis}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.unitOfAnalysis].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.unitOfAnalysis].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.unitOfAnalysis].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="unitOfAnalysis" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.universe].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.universe].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.universeLabel}" title="#{editstudybundle.universeHelpHeading} - #{editstudybundle.universeHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.universe].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.universe].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_universe"
                                     value="#{TemplateFormPage.template.metadata.universe}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.universe].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_universe"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneUniverse" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.universe].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.universe}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.universe].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.universe].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.universe].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="universe" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

               <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.kindOfData].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.kindOfData].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.kindOfDataLabel}" title="#{editstudybundle.kindOfDataHelpHeading} - #{editstudybundle.kindOfDataHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.kindOfData].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.kindOfData].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_kindOfData"
                                     value="#{TemplateFormPage.template.metadata.kindOfData}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.kindOfData].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_kindOfData"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneKindOfData" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.kindOfData].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.kindOfData}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.kindOfData].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.kindOfData].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.kindOfData].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="kindOfData" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>
              
              <!-- data collection methodology section -->
              <!-- DCM header-->
              <div jsfc="ice:panelGroup" styleClass="vdcStudyInfoHeader #{TemplateFormPage.dataCollectionMethodologyInputLevel}">
                <ice:outputText value="Data Collection / Methodology"/>
              </div>
              <!-- end of DCM header-->

              <!-- Add Field section -->
              <div jsfc="ice:panelGroup" styleClass="dvnStudyTemplateDCMBlock" rendered="#{TemplateFormPage.networkEdit}">
                <ice:panelGrid cellpadding="0" cellspacing="0" columns="1" width="100%">
                    <ice:column>
                        <p>
                          <ice:graphicImage value="/resources/images/icon_info.gif" styleClass="dvn_icon"/>
                          <ice:outputText styleClass="vdcHelpText" value=" #{bundlePageInfo.editTemplateAddFieldsHelp}" escape="false"/>
                        </p>
                        <div jsfc="ice:panelGroup" styleClass="dvnWarningMessage" rendered="#{!empty VDCRender.flash.customFieldWarningMessage}">
                          <div class="dvnMsgBlockContainer">
                            <p><ice:outputText id="addFieldMessage" value="#{VDCRender.flash.customFieldWarningMessage}"/></p>
                          </div>
                        </div>
                        <div>
                            <ice:outputText value="Field Type"/>
                            <ice:selectOneMenu immediate="false" partialSubmit="false" binding="#{TemplateFormPage.selectFieldType}">
                                <f:selectItems value="#{TemplateFormPage.fieldTypeSelectItems}"/>
                            </ice:selectOneMenu>
                        </div>
                        <div>
                            <ice:outputText value="Field Name"/>
                            <ice:inputText id="input_adHocFieldName" size="90" binding="#{TemplateFormPage.inputStudyFieldName}"></ice:inputText>
                        </div>
                        <div>
                            <ice:outputText value="Field Description"/>
                            <ice:inputText id="input_adHocFieldDescription" size="90" binding="#{TemplateFormPage.inputStudyFieldDescription}"></ice:inputText>
                        </div>
                        <div class="dvnFormPadding">
                            <ice:selectBooleanCheckbox partialSubmit="false" binding="#{TemplateFormPage.allowMultiplesCheck}"/>
                            <ice:outputText value="Allow multiple values"/>
                        </div>
                        <div class="dvnFormPadding">
                            <ice:commandButton partialSubmit="true" value="Add Field" action="#{TemplateFormPage.addCustomField}"/>
                        </div>
                    </ice:column>
                </ice:panelGrid>
              </div>
              <!-- End of Add-->
              
              <!-- Generic control-->              
              <ice:panelSeries value="#{TemplateFormPage.customFieldsDataModel}" var="customFieldsDataModel"
                               binding="#{TemplateFormPage.customFieldsPanelSeries}">                                  
                  <ice:dataTable cellpadding="0" cellspacing="0" width="100%" 
                                 rendered="#{empty(customFieldsDataModel[0].controlledVocabulary) and (TemplateFormPage.networkEdit or customFieldsDataModel[0].fieldInputLevelString != 'disabled')}"
                                 styleClass="vdcEditStudyTable #{customFieldsDataModel[0].fieldInputLevelString}" columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3"
                                 value="#{customFieldsDataModel[1]}" var="customValuesDataModel">
                    <ice:column styleClass="vdcEditStudyField">
                       <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{customFieldsDataModel[0].studyField.title}" 
                                          rendered="#{customFieldsDataModel[1].rowIndex==0}"
                                        title="#{customFieldsDataModel[0].studyField.title} - #{customFieldsDataModel[0].studyField.description}"/>
                       <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{customFieldsDataModel[0].required and (customFieldsDataModel[1].rowIndex==0)}"/>
                       <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{customFieldsDataModel[0].recommended and (customFieldsDataModel[1].rowIndex==0)}"/>
                    </ice:column>
                    <ice:column>
                          <ice:inputText id="input_TextDefault" size="90" rendered="#{empty(customFieldsDataModel[0].studyField.fieldType)}"                                        
                                         value="#{customValuesDataModel[0].strValue}">
                          </ice:inputText> 
                          <ice:message styleClass="errorMessage" for="input_TextDefault"/>
                          <ice:inputText id="input_HtmlEnabled" size="90" rendered="#{customFieldsDataModel[0].studyField.fieldType == 'html'}"                                          
                                         value="#{customValuesDataModel[0].strValue}"
                                         styleClass="formHtmlEnabled">
                          </ice:inputText>
                          <ice:message styleClass="errorMessage" for="input_HtmlEnabled"/>
                          <ice:inputTextarea id="input_HtmlEnabledArea" cols="90" rows="4" rendered="#{customFieldsDataModel[0].studyField.fieldType == 'htmlarea'}"                                          
                                         value="#{customValuesDataModel[0].strValue}"
                                         styleClass="formHtmlEnabled">
                          </ice:inputTextarea>
                          <ice:message styleClass="errorMessage" for="input_HtmlEnabledArea"/>
                          <ice:inputText id="input_Text" size="90" rendered="#{customFieldsDataModel[0].studyField.fieldType == 'textBox'}" 
                                         value="#{customValuesDataModel[0].strValue}">
                          </ice:inputText>  
                          <ice:message styleClass="errorMessage" for="input_Text"/>
                          <ice:inputText id="input_genericDate" styleClass="formDateFormat"
                                         rendered="#{customFieldsDataModel[0].studyField.fieldType == 'date'}" 
                                         value="#{customValuesDataModel[0].strValue}">
                          </ice:inputText>   
                          <ice:outputText value="#{editstudybundle.dateFormatDescription}" rendered="#{customFieldsDataModel[0].studyField.fieldType == 'date'}"/>
                          <ice:message styleClass="errorMessage" for="input_genericDate"/>
                          <ice:inputTextarea cols="90" rows="4"
                                               id="input_TextArea"
                                               value="#{customValuesDataModel[0].strValue}"
                                               rendered="#{customFieldsDataModel[0].studyField.fieldType == 'textArea'}">
                          </ice:inputTextarea>
                          <ice:message styleClass="errorMessage" for="input_TextArea"/>
                
                    </ice:column>
                    <ice:column>
                        <ice:commandButton rendered="#{customFieldsDataModel[0].allowMultiples}"
                                alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addCustomRow}"/>       
                        <ice:commandButton rendered="#{customValuesDataModel[1].size() > 1}" 
                                alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeCustomRow}"/>

                       <ice:commandLink value="Select Vocabulary" 
                                        rendered="#{customFieldsDataModel[1].rowIndex==0}" 
                                       actionListener="#{TemplateFormPage.openPopup}"/>

                        <ice:selectOneMenu immediate="false" partialSubmit="true" rendered="#{customFieldsDataModel[1].rowIndex==0}"
                                           value="#{customFieldsDataModel[0].fieldInputLevelString}" >
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                        </ice:selectOneMenu>

                        <ice:commandButton value="Move Up" alt="Move Up" title="Move Up" rendered="#{TemplateFormPage.networkEdit and customFieldsDataModel[1].rowIndex==0}"
                                         image="/resources/images/icon_moveup.png" actionListener="#{TemplateFormPage.moveUp}"/>
                        <ice:commandButton value="Move Down" alt="Move Down" title="Move Down" rendered="#{TemplateFormPage.networkEdit and customFieldsDataModel[1].rowIndex==0}" 
                                         image="/resources/images/icon_movedown.png" actionListener="#{TemplateFormPage.moveDown}"/>

                          <ice:commandLink value="Remove" rendered="#{(TemplateFormPage.networkEdit and customFieldsDataModel[1].rowIndex==0)
                                            and ((customFieldsDataModel[0].studyField.id == null) or TemplateFormPage.fieldRemovable) }" 
                                           actionListener="#{TemplateFormPage.removeCustomField}"/>
                    </ice:column>
                  </ice:dataTable>
                  
<!-- Start of Controlled vocab stuff-->
                  <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{customFieldsDataModel[0].fieldInputLevelString}"
                             rendered="#{!empty(customFieldsDataModel[0].controlledVocabulary) 
                                         and (TemplateFormPage.networkEdit or customFieldsDataModel[0].fieldInputLevelString != 'disabled')}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                    <ice:column styleClass="vdcEditStudyField">                          
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{customFieldsDataModel[0].studyField.title}" 
                                        title="#{customFieldsDataModel[0].studyField.title} - #{customFieldsDataModel[0].studyField.description}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{customFieldsDataModel[0].required}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{customFieldsDataModel[0].recommended}"/>
                    </ice:column>
                    <ice:column>
                        <ice:selectOneMenu immediate="false"   id="selectOneCustom"                                          
                                           value="#{customFieldsDataModel[3].studyFieldValueSingleString}" 
                                           valueChangeListener="#{TemplateFormPage.changeSingleValCV}"                                          
                                        rendered ="#{!customFieldsDataModel[0].allowMultiples}">
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{customFieldsDataModel[0].controlledVocabulary.selectItems}"/>
                            <f:attribute name="sf_id" value="#{customFieldsDataModel[0].studyField.id}"/>
                        </ice:selectOneMenu>  
                         <ice:message styleClass="errorMessage" for="selectOneCustom"/>
                        <ice:selectManyListbox immediate="false" id="selectManyCustom"   
                                               valueChangeListener="#{TemplateFormPage.changeMultiValCV}" 
                                               value="#{customFieldsDataModel[3].studyFieldValueStrings}"
                                        rendered ="#{customFieldsDataModel[0].allowMultiples }">
                            <f:selectItems value="#{customFieldsDataModel[0].controlledVocabulary.selectItems}"/>
                            <f:attribute name="sf_id" value="#{customFieldsDataModel[0].studyField.id}"/>
                        </ice:selectManyListbox>
                         <ice:message styleClass="errorMessage" for="selectManyCustom"/>
                    </ice:column>
                    <ice:column>
                        <ice:commandLink value="Select Vocabulary" 
                                         actionListener="#{TemplateFormPage.openPopup}"/>

                        <ice:selectOneMenu immediate="false" partialSubmit="true"
                                           value="#{customFieldsDataModel[0].fieldInputLevelString}" >
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                        </ice:selectOneMenu>

                        <ice:commandButton value="Move Up" alt="Move Up" title="Move Up" rendered="#{TemplateFormPage.networkEdit}"
                                   image="/resources/images/icon_moveup.png" actionListener="#{TemplateFormPage.moveUp}"/>
                        <ice:commandButton value="Move Down" alt="Move Down" title="Move Down" rendered="#{TemplateFormPage.networkEdit}"
                                   image="/resources/images/icon_movedown.png" actionListener="#{TemplateFormPage.moveDown}"/>
                        <ice:commandLink value="Remove" title="Remove Field" rendered="#{TemplateFormPage.networkEdit and (TemplateFormPage.fieldRemovable 
                                                                                         or (customFieldsDataModel[0].studyField.id == null))
                                                                                         }" 
                                         actionListener="#{TemplateFormPage.removeCustomField}"/>
                    </ice:column>
                </ice:panelGrid>
              </ice:panelSeries>
              
              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.timeMethod].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.timeMethod].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.timeMethodLabel}" title="#{editstudybundle.timeMethodHelpHeading} - #{editstudybundle.timeMethodHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.timeMethod].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.timeMethod].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_timeMethod" size="45" value="#{TemplateFormPage.template.metadata.timeMethod}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.timeMethod].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_timeMethod"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneTimeMethod" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.timeMethod].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.timeMethod}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.timeMethod].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.timeMethod].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.timeMethod].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="timeMethod" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.dataCollector].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.dataCollector].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.dataCollectorLabel}" title="#{editstudybundle.dataCollectorHelpHeading} - #{editstudybundle.dataCollectorHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.dataCollector].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.dataCollector].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_dataCollector" size="45" value="#{TemplateFormPage.template.metadata.dataCollector}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.dataCollector].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_dataCollector"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneDataCollector" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.dataCollector].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.dataCollector}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.dataCollector].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.dataCollector].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.dataCollector].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="dataCollector" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.frequencyOfDataCollectionLabel}" title="#{editstudybundle.frequencyHelpHeading} - #{editstudybundle.frequencyHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_frequencyOfDataCollection" size="45" value="#{TemplateFormPage.template.metadata.frequencyOfDataCollection}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_frequencyOfDataCollection"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneFrequencyOfDataCollection" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.frequencyOfDataCollection}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.frequencyOfDataCollection].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="frequencyOfDataCollection" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.samplingProcedure].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.samplingProcedure].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.samplingProcedureLabel}" title="#{editstudybundle.samplingProcedureHelpHeading} - #{editstudybundle.samplingProcedureHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.samplingProcedure].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.samplingProcedure].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_samplingProcedure"
                                     value="#{TemplateFormPage.template.metadata.samplingProcedure}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.samplingProcedure].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_samplingProcedure"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneSamplingProcedure" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.samplingProcedure].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.samplingProcedure}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.samplingProcedure].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.samplingProcedure].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.samplingProcedure].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="samplingProcedure" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.majorDeviationsLabel}" title="#{editstudybundle.majorDeviationsHelpHeading} - #{editstudybundle.majorDeviationsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_deviationsFromSampleDesign"
                                     value="#{TemplateFormPage.template.metadata.deviationsFromSampleDesign}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_deviationsFromSampleDesign"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneDeviationsFromSampleDesign" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.deviationsFromSampleDesign}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.deviationsFromSampleDesign].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="deviationsFromSampleDesign" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.collectionMode].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.collectionMode].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.collectionModeLabel}" title="#{editstudybundle.collectionModeHelpHeading} - #{editstudybundle.collectionModeHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.collectionMode].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.collectionMode].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_collectionMode" size="45" value="#{TemplateFormPage.template.metadata.collectionMode}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.collectionMode].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_collectionMode"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneCollectionMode" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.collectionMode].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.collectionMode}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.collectionMode].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.collectionMode].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.collectionMode].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="collectionMode" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.researchInstrument].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.researchInstrument].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.researchInstrumentLabel}" title="#{editstudybundle.researchInstrumentHelpHeading} - #{editstudybundle.researchInstrumentHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.researchInstrument].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.researchInstrument].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_researchInstrument" size="45" value="#{TemplateFormPage.template.metadata.researchInstrument}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.researchInstrument].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_researchInstrument"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneResearchInstrument" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.researchInstrument].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.researchInstrument}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.researchInstrument].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.researchInstrument].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.researchInstrument].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="researchInstrument" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.dataSources].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.dataSources].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.dataSourcesLabel}" title="#{editstudybundle.dataSourcesHelpHeading} - #{editstudybundle.dataSourcesHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.dataSources].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.dataSources].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_dataSources" size="45" value="#{TemplateFormPage.template.metadata.dataSources}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.dataSources].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_dataSources"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneDataSources" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.dataSources].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.dataSources}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.dataSources].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.dataSources].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.dataSources].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="dataSources" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.originOfSources].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.originOfSources].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.originOfSourcesLabel}" title="#{editstudybundle.originOfSourcesHelpHeading} - #{editstudybundle.originOfSourcesHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.originOfSources].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.originOfSources].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_originOfSources" size="45" value="#{TemplateFormPage.template.metadata.originOfSources}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.originOfSources].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_originOfSources"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneOriginOfSources" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.originOfSources].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.originOfSources}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.originOfSources].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.originOfSources].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.originOfSources].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="originOfSources" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.characteristicOfSources].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.characteristicOfSources].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.sourceCharacteristicsLabel}" title="#{editstudybundle.sourceCharacteristicsHelpHeading} - #{editstudybundle.sourceCharacteristicsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.characteristicOfSources].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.characteristicOfSources].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_characteristicOfSources" size="45" value="#{TemplateFormPage.template.metadata.characteristicOfSources}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.characteristicOfSources].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_characteristicOfSources"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneCharacteristicOfSources" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.characteristicOfSources].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.characteristicOfSources}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.characteristicOfSources].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.characteristicOfSources].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.characteristicOfSources].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="characteristicOfSources" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.accessToSources].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.accessToSources].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.sourceDocumentationLabel}" title="#{editstudybundle.sourceDocumentationHelpHeading} - #{editstudybundle.sourceDocumentationHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.accessToSources].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.accessToSources].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_accessToSources"
                                     value="#{TemplateFormPage.template.metadata.accessToSources}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.accessToSources].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_accessToSources"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneAccessToSources" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.accessToSources].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.accessToSources}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.accessToSources].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.accessToSources].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.accessToSources].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="accessToSources" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.dataCollectionSituation].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.dataCollectionSituation].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" 
                                  value="#{editstudybundle.dataCollectionCharacteristicsLabel}" title="#{editstudybundle.dataCollectionCharacteristicsHelpHeading} - #{editstudybundle.dataCollectionCharacteristicsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.dataCollectionSituation].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.dataCollectionSituation].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_dataCollectionSituation" size="45" value="#{TemplateFormPage.template.metadata.dataCollectionSituation}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.dataCollectionSituation].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_dataCollectionSituation"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneDataCollectionSituation" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.dataCollectionSituation].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.dataCollectionSituation}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.dataCollectionSituation].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.dataCollectionSituation].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.dataCollectionSituation].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="dataCollectionSituation" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.minimizeActionsLabel}" 
                                  title="#{editstudybundle.minimizeActionsHelpHeading} - #{editstudybundle.minimizeActionsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_actionsToMinimizeLoss" size="45" value="#{TemplateFormPage.template.metadata.actionsToMinimizeLoss}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_actionsToMinimizeLoss"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneActionsToMinimizeLoss" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.actionsToMinimizeLoss}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.actionsToMinimizeLoss].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="actionsToMinimizeLoss" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.controlOperations].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.controlOperations].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.controlOperationsLabel}" 
                                  title="#{editstudybundle.controlOperationsHelpHeading} - #{editstudybundle.controlOperationsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.controlOperations].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.controlOperations].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_controlOperations" size="45" value="#{TemplateFormPage.template.metadata.controlOperations}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.controlOperations].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_controlOperations"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneControlOperations" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.controlOperations].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.controlOperations}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.controlOperations].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.controlOperations].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.controlOperations].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="controlOperations" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.weighting].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.weighting].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.weightingLabel}" 
                                  title="#{editstudybundle.weightingHelpHeading} - #{editstudybundle.weightingHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.weighting].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.weighting].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_weighting" size="45" value="#{TemplateFormPage.template.metadata.weighting}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.weighting].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_weighting"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneWeighting" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.weighting].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.weighting}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.weighting].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.weighting].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.weighting].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="weighting" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.cleaningOperations].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.cleaningOperations].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.cleaningOperationsLabel}" 
                                  title="#{editstudybundle.cleaningOperationsHelpHeading} - #{editstudybundle.cleaningOperationsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.cleaningOperations].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.cleaningOperations].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_cleaningOperations" size="45" value="#{TemplateFormPage.template.metadata.cleaningOperations}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.cleaningOperations].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_cleaningOperations"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneCleaningOperations" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.cleaningOperations].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.cleaningOperations}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.cleaningOperations].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.cleaningOperations].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.cleaningOperations].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="cleaningOperations" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.studyLevelErrorNotesLabel}" 
                                  title="#{editstudybundle.studyLevelErrorNotesHelpHeading} - #{editstudybundle.studyLevelErrorNotesHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_studyLevelErrorNotes" size="45" value="#{TemplateFormPage.template.metadata.studyLevelErrorNotes}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_studyLevelErrorNotes"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneStudyLevelErrorNotes" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.studyLevelErrorNotes}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.studyLevelErrorNotes].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="studyLevelErrorNotes" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.responseRate].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.responseRate].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.responseRateLabel}" 
                                  title="#{editstudybundle.responseRateHelpHeading} - #{editstudybundle.responseRateHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.responseRate].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.responseRate].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_responseRate" size="45" value="#{TemplateFormPage.template.metadata.responseRate}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.responseRate].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_responseRate"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneResponseRate" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.responseRate].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.responseRate}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.responseRate].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.responseRate].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.responseRate].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="responseRate" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.samplingErrorEstimates].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.samplingErrorEstimates].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.samplingErrorLabel}" 
                                  title="#{editstudybundle.samplingErrorHelpHeading} - #{editstudybundle.samplingErrorHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.samplingErrorEstimates].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.samplingErrorEstimates].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_samplingErrorEstimates" size="45" value="#{TemplateFormPage.template.metadata.samplingErrorEstimate}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.samplingErrorEstimates].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_samplingErrorEstimates"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneSamplingErrorEstimates" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.samplingErrorEstimates].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.samplingErrorEstimate}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.samplingErrorEstimates].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.samplingErrorEstimates].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.samplingErrorEstimates].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="samplingErrorEstimates" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.otherDataAppraisal].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.otherDataAppraisal].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip"   value="#{editstudybundle.otherDataAppraisalLabel}" 
                                  title="#{editstudybundle.otherDataAppraisalHelpHeading} - #{editstudybundle.otherDataAppraisalHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.otherDataAppraisal].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.otherDataAppraisal].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_otherDataAppraisal" size="45" value="#{TemplateFormPage.template.metadata.otherDataAppraisal}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.otherDataAppraisal].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_otherDataAppraisal"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneOtherDataAppraisal" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.otherDataAppraisal].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.otherDataAppraisal}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.otherDataAppraisal].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.otherDataAppraisal].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.otherDataAppraisal].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="otherDataAppraisal" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

               <!-- end of data collection methodology section --> 
              
              <!-- DATA SET AVAILABILITY SECTION -->
              <div jsfc="ice:panelGroup" styleClass="vdcStudyInfoHeader #{TemplateFormPage.dataSetAvailabilityInputLevel}">
                <ice:outputText value="Data Set Availability"/>
              </div>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.placeOfAccess].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.placeOfAccess].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3" id="gridPanel5a">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.dataAccessPlaceLabel}" title="#{editstudybundle.dataAccessPlaceHelpHeading} - #{editstudybundle.dataAccessPlaceHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.placeOfAccess].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.placeOfAccess].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_placeOfAccess" size="45" value="#{TemplateFormPage.template.metadata.placeOfAccess}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.placeOfAccess].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_placeOfAccess"/>

                  <ice:selectOneMenu immediate="false"   id="selectOnePlaceOfAccess" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.placeOfAccess].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.placeOfAccess}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.placeOfAccess].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.placeOfAccess].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.placeOfAccess].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="placeOfAccess" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.originalArchive].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.originalArchive].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.originalArchiveLabel}" title="#{editstudybundle.originalArchiveHelpHeading} - #{editstudybundle.originalArchiveHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.originalArchive].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.originalArchive].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_originalArchive" size="45" value="#{TemplateFormPage.template.metadata.originalArchive}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.originalArchive].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_originalArchive"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneOriginalArchive" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.originalArchive].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.originalArchive}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.originalArchive].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.originalArchive].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.originalArchive].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="originalArchive" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.availabilityStatus].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.availabilityStatus].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.availabilityLabel}" title="#{editstudybundle.availabilityHelpHeading} - #{editstudybundle.availabilityHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.availabilityStatus].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.availabilityStatus].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_availabilityStatus" size="45" value="#{TemplateFormPage.template.metadata.availabilityStatus}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.availabilityStatus].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_availabilityStatus"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneAvailabilityStatus" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.availabilityStatus].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.availabilityStatus}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.availabilityStatus].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.availabilityStatus].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.availabilityStatus].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="availabilityStatus" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.collectionSize].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.collectionSize].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.collectionSizeLabel}" title="#{editstudybundle.collectionSizeHelpHeading} - #{editstudybundle.collectionSizeHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.collectionSize].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.collectionSize].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_collectionSize" size="45" value="#{TemplateFormPage.template.metadata.collectionSize}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.collectionSize].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_collectionSize"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneCollectionSize" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.collectionSize].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.collectionSize}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.collectionSize].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.collectionSize].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.collectionSize].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="collectionSize" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.studyCompletion].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.studyCompletion].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.studyCompletionLabel}" title="#{editstudybundle.studyCompletionHelpHeading} - #{editstudybundle.studyCompletionHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.studyCompletion].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.studyCompletion].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_studyCompletion" size="45" value="#{TemplateFormPage.template.metadata.studyCompletion}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.studyCompletion].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_studyCompletion"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneStudyCompletion" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.studyCompletion].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.studyCompletion}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.studyCompletion].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.studyCompletion].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.studyCompletion].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="studyCompletion" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>
              
              <!-- TERMS OF USE SECTION -->
              <div jsfc="ice:panelGroup" styleClass="vdcStudyInfoHeader #{TemplateFormPage.termsOfUseInputLevel}">
                <ice:outputText value="Terms of Use"/>
              </div>
              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.confidentialityDeclaration].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.confidentialityDeclaration].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3" id="gridPanel5">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.confidentialityLabel}" title="#{editstudybundle.confidentialityHelpHeading} - #{editstudybundle.confidentialityHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.confidentialityDeclaration].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.confidentialityDeclaration].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_confidentialityDeclaration"
                                     value="#{TemplateFormPage.template.metadata.confidentialityDeclaration}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.confidentialityDeclaration].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_confidentialityDeclaration"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneConfidentialityDeclaration" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.confidentialityDeclaration].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.confidentialityDeclaration}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.confidentialityDeclaration].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.confidentialityDeclaration].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.confidentialityDeclaration].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="confidentialityDeclaration" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.specialPermissions].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.specialPermissions].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.specialPermissionsLabel}" title="#{editstudybundle.specialPermissionsHelpHeading} - #{editstudybundle.specialPermissionsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.specialPermissions].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.specialPermissions].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_specialPermissions"
                                     value="#{TemplateFormPage.template.metadata.specialPermissions}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.specialPermissions].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_specialPermissions"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneSpecialPermissions" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.specialPermissions].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.specialPermissions}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.specialPermissions].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.specialPermissions].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.specialPermissions].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="specialPermissions" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.restrictions].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.restrictions].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.restrictionsLabel}" title="#{editstudybundle.restrictionsHelpHeading} - #{editstudybundle.restrictionsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.restrictions].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.restrictions].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_restrictions"
                                     value="#{TemplateFormPage.template.metadata.restrictions}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.restrictions].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_restrictions"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneRestrictions" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.restrictions].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.restrictions}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.restrictions].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.restrictions].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.restrictions].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="restrictions" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.contact].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.contact].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.contactLabel}" title="#{editstudybundle.contactHelpHeading} - #{editstudybundle.contactHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.contact].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.contact].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputText id="input_contact" size="45" value="#{TemplateFormPage.template.metadata.contact}" 
                                 rendered="#{empty(TemplateFormPage.studyMap[sfc.contact].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled"/>
                  <ice:message styleClass="errorMessage" for="input_contact"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneContact" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.contact].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.contact}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.contact].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.contact].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.contact].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="contact" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.citationRequirements].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                TemplateFormPage.studyMap[sfc.citationRequirements].templateField.fieldInputLevelString != 'disabled'}"                           
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.citationRequirementsLabel}" title="#{editstudybundle.citationRequirementsHelpHeading} - #{editstudybundle.citationRequirementsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.citationRequirements].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.citationRequirements].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_citationRequirements"
                                     value="#{TemplateFormPage.template.metadata.citationRequirements}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.citationRequirements].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_citationRequirements"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneCitationRequirements" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.citationRequirements].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.citationRequirements}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.citationRequirements].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.citationRequirements].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.citationRequirements].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="citationRequirements" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" columns="3" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.depositorRequirements].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                            TemplateFormPage.studyMap[sfc.depositorRequirements].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.depositorRequirementsLabel}" title="#{editstudybundle.depositorRequirementsHelpHeading} - #{editstudybundle.depositorRequirementsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.depositorRequirements].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.depositorRequirements].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_depositorRequirements"
                                     value="#{TemplateFormPage.template.metadata.depositorRequirements}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.depositorRequirements].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_depositorRequirements"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneDepositorRequirements" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.depositorRequirements].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.depositorRequirements}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.depositorRequirements].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.depositorRequirements].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.depositorRequirements].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="depositorRequirements" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.conditions].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                            TemplateFormPage.studyMap[sfc.conditions].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3" columns="3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.conditionsLabel}" title="#{editstudybundle.conditionsHelpHeading} - #{editstudybundle.conditionsHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.conditions].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.conditions].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_conditions"
                                     value="#{TemplateFormPage.template.metadata.conditions}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.conditions].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_conditions"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneConditions" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.conditions].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.conditions}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.conditions].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.conditions].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.conditions].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="conditions" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <ice:panelGrid cellpadding="0" cellspacing="0" width="100%"
                             styleClass="vdcEditStudyTable #{TemplateFormPage.studyMap[sfc.disclaimer].templateField.fieldInputLevelString}"
                             rendered="#{TemplateFormPage.networkEdit or 
                                            TemplateFormPage.studyMap[sfc.disclaimer].templateField.fieldInputLevelString != 'disabled'}"
                             columnClasses="vdcEditStudyCol1, vdcEditStudyCol2, vdcEditStudyCol3" columns="3">
                <ice:column styleClass="vdcEditStudyField">
                  <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.disclaimerLabel}" title="#{editstudybundle.disclaimerHelpHeading} - #{editstudybundle.disclaimerHelp}"/>
                  <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.disclaimer].required}"/>
                  <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.disclaimer].recommended}"/>
                </ice:column>
		<ice:column>
                  <ice:inputTextarea cols="90" rows="4"
                                     id="input_disclaimer"
                                     value="#{TemplateFormPage.template.metadata.disclaimer}"                                     
                                     rendered="#{empty(TemplateFormPage.studyMap[sfc.disclaimer].templateField.controlledVocabulary)}" styleClass="formHtmlEnabled">
                  </ice:inputTextarea>

                  <ice:message styleClass="errorMessage" for="input_disclaimer"/>

                  <ice:selectOneMenu immediate="false"   id="selectOneDisclaimer" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.disclaimer].templateField.controlledVocabulary)}"                                          
                                           value="#{TemplateFormPage.template.metadata.disclaimer}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.disclaimer].templateField.controlledVocabulary.selectItems}"/>
                 </ice:selectOneMenu>  
                </ice:column>
                <ice:column>
                 <ice:commandLink value="Select Vocabulary"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.disclaimer].templateField)}"/>
                  <ice:selectOneMenu immediate="false" partialSubmit="true" 
                                        value="#{TemplateFormPage.studyMap[sfc.disclaimer].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="disclaimer" />
                           <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                  </ice:selectOneMenu>
                </ice:column>
              </ice:panelGrid>

              <!-- OTHER INFORMATION SECTION -->
              <div jsfc="ice:panelGroup" styleClass="vdcStudyInfoHeader #{TemplateFormPage.studyMap[sfc.note].templateField.fieldInputLevelString}">
                <ice:outputText value="Other Information"/>
              </div>
              <!-- this is a dummy datatable wrapper used to force data retention on validation error-->
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                             styleClass="vdcEditStudyTable"
                             rendered="#{TemplateFormPage.networkEdit or 
                                            TemplateFormPage.studyMap[sfc.note].templateField.fieldInputLevelString != 'disabled'}"
                             rowClasses="#{TemplateFormPage.studyMap[sfc.note].templateField.fieldInputLevelString}" value="dummy_datatable">
                <ice:column>
                  <ice:dataTable id="dataTableNotes" cellpadding="0" cellspacing="0" width="100%"
                                 styleClass="vdcEditStudyInnerTable" columnClasses="vdcEditStudyCol1b, vdcEditStudyCol2, vdcEditStudyCol3"
                                 binding="#{TemplateFormPage.dataTableNotes}"
                                 value="#{TemplateFormPage.template.metadata.studyNotes}" var="currentRow">
                    <ice:column>
                      <div class="vdcEditStudyField">
                        <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.notesLabel}" title="#{editstudybundle.notesHelpHeading} - #{editstudybundle.notesHelp}"/>
                        <ice:graphicImage value="/resources/images/icon_required.gif" rendered="#{TemplateFormPage.studyMap[sfc.note].required}"/>
                        <ice:graphicImage value="/resources/images/icon_recommended.gif" rendered="#{TemplateFormPage.studyMap[sfc.note].recommended}"/>
                      </div>
                    </ice:column>
                    <ice:column>
                      <div class="vdcEditStudyFieldFloatWrap">
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat1 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.notesTypeLabel}" title="#{editstudybundle.notesTypeHelpHeading} - #{editstudybundle.notesTypeHelp}"/>
                          <ice:inputText maxlength="255" binding="#{TemplateFormPage.inputNoteType}" id="input_notesInformationType"
                                         value="#{currentRow.type}"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.notesInformationType].templateField.controlledVocabulary)}" 
                                         styleClass="formHtmlEnabled">
                          </ice:inputText>                        
                         <ice:selectOneMenu immediate="false"   id="selectOnenoteType" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.notesInformationType].templateField.controlledVocabulary)}"                                          
                                           value="#{currentRow.type}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.notesInformationType].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>  
                          <ice:message styleClass="errorMessage" for="input_notesInformationType"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat2 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.notesSubjectLabel}" title="#{editstudybundle.notesSubjectHelpHeading} - #{editstudybundle.notesSubjectHelp}"/>
                          <ice:inputText id="input_notesInformationSubject"
                                         maxlength="255"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.notesInformationSubject].templateField.controlledVocabulary)}" 
                                         binding="#{TemplateFormPage.inputNoteSubject}"
                                         value="#{currentRow.subject}"
                                         styleClass="formHtmlEnabled">
                          </ice:inputText>
                        <ice:selectOneMenu immediate="false"   id="selectOnenoteSubject" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.notesInformationSubject].templateField.controlledVocabulary)}"                                          
                                           value="#{currentRow.subject}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.notesInformationSubject].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu> 
                          <ice:message styleClass="errorMessage" for="input_notesInformationSubject"/>
                        </div>
                        <div jsfc="ice:panelGroup" styleClass="vdcEditStudyFieldFloat3 vdcEditStudyGroupField">
                          <ice:outputText styleClass="dvnInlineHelpLabel dvnInlineHelpTip" value="#{editstudybundle.notesTextLabel}" title="#{editstudybundle.notesTextHelpHeading} - #{editstudybundle.notesTextHelp}"/>
                          <ice:inputText id="input_notesText"
                                         size="90"
                                         rendered="#{empty(TemplateFormPage.studyMap[sfc.notesText].templateField.controlledVocabulary)}"
                                         binding="#{TemplateFormPage.inputNoteText}"
                                         value="#{currentRow.text}"
                                         styleClass="formHtmlEnabled">
                          </ice:inputText>
                          <ice:selectOneMenu immediate="false"   id="selectOnenotesText" 
                                     rendered="#{!empty(TemplateFormPage.studyMap[sfc.notesText].templateField.controlledVocabulary)}"                                          
                                           value="#{currentRow.text}" 
                                           >
                            <f:selectItem itemLabel="No Value" itemValue=""/>
                            <f:selectItems value="#{TemplateFormPage.studyMap[sfc.notesText].templateField.controlledVocabulary.selectItems}"/>
                        </ice:selectOneMenu>
                          <ice:message styleClass="errorMessage" for="input_notesText"/>
                        </div>
                      </div>
                    </ice:column>
                    <ice:column>
                      <ice:commandButton partialSubmit="true" alt="Add Row" title="Add Row" image="/resources/images/icon_add.gif" actionListener="#{TemplateFormPage.addRow}"/>
                      <ice:commandButton partialSubmit="true" rendered="#{TemplateFormPage.dataTableNotes.rowCount gt 1}" alt="Remove Row" title="Remove Row" image="/resources/images/icon_remove.gif" actionListener="#{TemplateFormPage.removeRow}"/>
                      <ice:commandLink value="Select Vocabulary" rendered ="#{TemplateFormPage.dataTableNotes.rowIndex==0}"
                                       action="#{TemplateFormPage.openPopupStandard(TemplateFormPage.studyMap[sfc.note].templateField)}"/>                      
                      <ice:selectOneMenu immediate="false" partialSubmit="true" rendered ="#{TemplateFormPage.dataTableNotes.rowIndex==0}"
                                        value="#{TemplateFormPage.studyMap[sfc.note].templateField.fieldInputLevelString}">
                            <f:attribute name="fieldName" value="notesInformationType" />
                            <f:selectItems value="#{TemplateFormPage.fieldInputLevelSelectItems}"/>
                      </ice:selectOneMenu>
                    </ice:column>
                  </ice:dataTable>
                </ice:column>
              </ice:dataTable>
            </div>
            <div class="vdcTextRight dvnFormPadding dvnFormMargin">
              <ice:commandButton id="button1b" value="Save" action="#{TemplateFormPage.save}"/>
              <ice:commandButton immediate="true" id="button2b" value="Cancel" action="#{TemplateFormPage.cancel}"/>
            </div>
          </div>
        </div>
        <ice:panelPopup id="controlledVocabularyPopup"
                        draggable="false"
                        visible="#{TemplateFormPage.showPopup}"
                        autoCentre="true"
                        modal="true"
                        style="#{VDCRequest.displayInFrame ? 'top:50px !important;' : ' '}">
            <f:facet name="header">
                <ice:panelGrid id="autoCentPanelGrid"
                               width="100%" cellpadding="0"
                               cellspacing="0" columns="2"
                               columnClasses="none,popupButton">
                    <ice:outputText value="Select Controlled Vocabulary"/>
                </ice:panelGrid>
            </f:facet>
            <f:facet name="body">
                <ice:panelGrid id="autoCentContent" width="100%" cellpadding="0" cellspacing="0" columns="1" styleClass="popupModalBody">
                    <ice:column>
                     <div>Select the controlled vocabulary terms that apply to this study template.</div>
                     <ice:panelSeries value="#{TemplateFormPage.templateFieldCVs}" var="currentRow"
                               binding="#{TemplateFormPage.controlledVocabularyPopupPanelSeries}"> 
                        
                            <div>
                            <ice:outputText value="Controlled Vocabulary for #{currentRow.studyBundleLabel}" />
                            <ice:selectOneMenu immediate="false" partialSubmit="true" value="#{currentRow.cvId}"
                                               valueChangeListener="#{TemplateFormPage.changePopupControlledVocabulary}">
                                <f:selectItem itemLabel="--none--" itemValue="0"/>
                                <f:selectItems value="#{currentRow.controlledVocabularyOptions}"/>
                            </ice:selectOneMenu>  
                            </div>
                         <div></div>
                         <div jsfc="ice:panelGroup">
                            <ice:outputText value="Description: #{currentRow.controlledVocabDisplay.description}" 
                                            rendered="#{!empty currentRow.controlledVocabDisplay}"/>
                        </div>                                                
                        <div jsfc="ice:panelGroup" styleClass="dvnControlledVocabularyValuesBlock dvnFormPadding"
                             rendered="#{!empty currentRow.controlledVocabDisplay}">
                            <ui:repeat value="#{currentRow.controlledVocabDisplay.controlledVocabularyValues}" var="item">
                                <ice:outputText value="#{item.value}"/>
                            </ui:repeat>
                        </div>
                        </ice:panelSeries>  

                        <div jsfc="ice:panelGroup" styleClass="dvnFormPadding dvnFormMargin">
                            <ice:commandButton id="autoCentPopupApply" immediate="true" actionListener="#{TemplateFormPage.savePopup}" value="Save"/>
                            <ice:commandButton id="autoCentPopupCancel" immediate="true" actionListener="#{TemplateFormPage.closePopup}" value="Cancel"/>
                        </div>
                    </ice:column>
                </ice:panelGrid>
            </f:facet>
        </ice:panelPopup>

      </ice:form>
    </ui:define>
  </ui:composition>

</body>
</html>
