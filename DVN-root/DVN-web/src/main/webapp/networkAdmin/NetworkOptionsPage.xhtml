<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsp="http://java.sun.com/JSP/Page"
      xmlns:ace="http://www.icefaces.org/icefaces/components"
      xmlns:ice="http://www.icesoft.com/icefaces/component">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
    <ui:composition template="/template.xhtml">
        <ui:param name="pageTitle" value="Dataverse Network Admin Options - #{VDCRequest.dataversePageTitle}"/>
        <ui:define name="metadata">
            <f:metadata>
                <f:event type="preRenderView" listener="#{OptionsPage.preRenderView}"/>  
                <f:event type="preRenderView" listener="#{ManageSubnetworksPage.preRenderView}"/> 
                <f:event type="preRenderView" listener="#{EditNetworkNamePage.preRenderView}"/> 
                <f:event type="preRenderView" listener="#{EditNetworkAnnouncementsPage.preRenderView}"/> 
                <f:event type="preRenderView" listener="#{EditBannerFooterPage.preRenderView}"/>  
                <f:event type="preRenderView" listener="#{EditSitePage.preRenderView}"/> 
                <f:viewParam name="oauth_verifier" value="#{OptionsPage.twitterVerifier}"/>
                <f:viewParam name="tab" value="#{OptionsPage.tab}"/>
                <f:viewParam name="tab2" value="#{OptionsPage.tab2}"/>
            </f:metadata>
        </ui:define> 
        <ui:define name="body">
            <ice:form id="form1" rendered="#{VDCRequest.currentVDC == null}">
            <ice:inputHidden binding="#{OptionsPage.hiddenAlphaCharacter}"
                      id="alphaCharacter"
                valueChangeListener="#{OptionsPage.changeAlphaCharacter}"/>
            <script type="text/javascript">
                // <![CDATA[
                    function initGuestBookResponses(){
                        document.getElementById('form1:initGuestBookResponse').click();
                    }
                    function initUserData(){
                        document.getElementById('form1:initUserData').click();
                    } 
                    function initControlledVocabulary(){
                        document.getElementById('form1:initControlledVocabulary').click();
                    }
                    function initPrivilegedUserData(){
                        document.getElementById('form1:initPrivilegedUserData').click();
                    }
                    function initTemplates(){
                        document.getElementById('form1:initTemplates').click();
                    }
                    function initSubnetworks(){
                        document.getElementById('form1:initSubnetworks').click();
                    } 
                    function initCheckTermsEnabled() {
                        jQuery('div.dvnTermsEnable input.iceSelBoolChkbx[type=checkbox]').each(function(){
                            if ( jQuery(this).is(':checked') ) {
                                jQuery(this).parent().siblings('div.dvnTermsField').show();
                            } else {
                                jQuery(this).parent().siblings('div.dvnTermsField').hide();
                            }
                        });
                        jQuery('div.dvnTermsEnable input.iceSelBoolChkbx').bind("change", function(){
                            var self = jQuery(this);

                            self.parent().siblings('div.dvnTermsField').toggle();
                        });
                    }
                    var timeout= 800; //milliseconds to wait for no activity
                        var countEvents= 0;
                        function delayedRequest(form,field,event){
                            countEvents++;
                            setTimeout(function() {
                            countEvents--;
                                if(countEvents==0){               
                                    document.getElementById('form1:updateUserList').click();
                                }
                            },timeout);
                        }
                    
                // ]]>
            </script>
            <ice:commandButton visible="false" id="initGuestBookResponse" action="#{OptionsPage.initGuestBookResponses}"/>
            <ice:commandButton visible="false" id="initUserData" action="#{OptionsPage.initUserData}"/>
            <ice:commandButton visible="false" id="initControlledVocabulary" action="#{OptionsPage.initControlledVocabulary}"/>
            <ice:commandButton visible="false" id="initPrivilegedUserData" action="#{OptionsPage.initPrivilegedUserData}"/>
            <ice:commandButton visible="false" id="initTemplates" action="#{OptionsPage.initTemplates}"/>
            <ice:commandButton visible="false" id="initSubnetworks" action="#{ManageSubnetworksPage.initSubnetworks}"/>
            <ice:commandButton visible="false" id="updateUserList" action="#{OptionsPage.updateAllUsersList}"/>
            <div class="dvn_section">
                <ice:panelTabSet id="tabSet1" binding="#{OptionsPage.tabSet1}"  styleClass="dvnTabs">
                    <!-- DATAVERSE OPTIONS -->   
                    <ice:panelTab id="networkOptions" label="Dataverses" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=dataverseOptions" rendered="#{VDCSession.loginBean.networkAdmin}">

                            <div jsfc="ice:panelGroup" id="layoutPanel5" label="Dataverses" panelLayout="flow">
                                <ice:panelTabSet id="tabSetDataverses" styleClass="dvnTabs dvnSubTabs">
                                    <!-- Create New -->
                                    <ice:panelTab id="manageDvsSub" label="Dataverses">
                                        <div jsfc="ice:panelGroup">
                                            <div jsfc="ice:panelGroup" panelLayout="flow">
                                                <ui:include src="/networkAdmin/ManageDataversesPage.xhtml"></ui:include>
                                            </div> 
                                        </div>
                                    </ice:panelTab>
                                     <ice:panelTab id="reviewComments" label="Study Comments">
                                        <div jsfc="ice:panelGroup">
                                            <div jsfc="ice:panelGroup" panelLayout="flow">
                                                <ui:include src="/networkAdmin/CommentReviewPage.xhtml"></ui:include>
                                            </div> 
                                        </div>
                                    </ice:panelTab>
                                </ice:panelTabSet>
                            </div>
          
                      </ice:panelTab>

                      <ice:panelTab id="networkSettingsTab" label="Settings" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=settings" rendered="#{VDCSession.loginBean.networkAdmin}">
                          <ice:panelTabSet id="tabSetSettings" styleClass="dvnTabs dvnSubTabs" binding="#{OptionsPage.networkGeneralSettingsSubTab}">
                             <ice:panelTab id="networkGeneralSettings" label="General">
                                 <div jsfc="ice:panelGroup">
                                     <ui:include src="/networkAdmin/EditNetworkNamePage.xhtml"></ui:include>
                                     <ui:include src="/networkAdmin/EditNetworkAnnouncementsPage.xhtml"></ui:include>
                                     <ui:include src="/admin/EditContactUsPage.xhtml"></ui:include>
                                     <table class="dvnOptionsTable" cellspacing="0" cellpadding="0" border="0">
                                        <tr>
                                            <td class="dvnOptionsTableOption">
                                                <ice:outputText rendered="#{MainLayoutBean.googleAnalyticsKey != null}" value="#{bundlePageInfo.webStatsTitle}"/>
                                                <ice:outputText rendered="#{MainLayoutBean.googleAnalyticsKey == null }" value="#{bundlePageInfo.webStatsTitle}"/>
                                            </td>
                                            <td>
                                                <ice:graphicImage rendered="#{MainLayoutBean.googleAnalyticsKey == null}" value="/resources/images/icon_warning.18.png" styleClass="dvn_icon"/>
                                                <ice:outputText rendered="#{MainLayoutBean.googleAnalyticsKey == null}"
                                                                id="siteStatsText"
                                                                value=" Google Analytics is not configured for this Dataverse Network"/>
                                                <ice:outputLink rendered="#{MainLayoutBean.googleAnalyticsKey != null }"
                                                                id="siteStatslink"
                                                                value="http://www.google.com/analytics/"
                                                                target="_blank">
                                                    <ice:outputText value="#{bundlePageInfo.webStatsText}"/>
                                                </ice:outputLink>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="dvnOptionsTableOption">
                                                <ice:outputText value="Dataverse Network Version"/>
                                            </td>
                                            <td>
                                                <ice:outputText value="#{VersionPage.versionNumber} build number #{VersionPage.bambooBuild}"/>
                                                <ice:outputText value=" - "/>
                                                <ice:outputLink value="http://thedata.org/book/software-license" target="_blank">
                                                    <ice:outputText value="License Information"/>
                                                </ice:outputLink>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="dvnOptionsTableOption">
                                                <ice:outputText value="Served By"/>
                                            </td>
                                            <td><ice:outputText value="#{VersionPage.serverName}"/></td>
                                        </tr>
                                     </table>
                                     <div id="groupPanel6" class="dvnFormPadding dvnFormMargin" >
                                         <ice:commandButton id="btnSaveSettings" value="#{bundle.saveButtonLabel} Changes"
                                                            rendered="#{!VDCRequest.readOnlyDatabase}"
                                                            action="#{OptionsPage.saveNetworkGeneralSettings_action}"/>
                                     </div>
                                 </div>
                             </ice:panelTab>
                            <ice:panelTab id="networkAdvancedSettings" label="Advanced">
                                 <ui:include src="/networkAdmin/EditNetworkDVRequirementsPage.xhtml"></ui:include>
                                 <div id="groupPanelAdvanced" class="dvnFormPadding dvnFormMargin">
                                    <ice:commandButton id="btnSaveAdvanced" value="#{bundle.saveButtonLabel} Changes" 
                                                       rendered="#{!VDCRequest.readOnlyDatabase}"
                                                       action="#{OptionsPage.saveNetworkAdvancedSettings_action}"/>
                                 </div>
                            </ice:panelTab>
                            <ice:panelTab id="networkCustomizartionSettings" label="Customization">
                                 <ui:include src="/admin/EditBannerFooterPage.xhtml"></ui:include>
                                 <div class="dvnFormPadding dvnFormMargin">
                                    <ice:commandButton id="saveButton" value="Save Changes" rendered="#{!VDCRequest.readOnlyDatabase}"
                                                       action="#{EditBannerFooterPage.save_action}"/>  
                                 </div>
                            </ice:panelTab>
                            <ice:panelTab id="twitterSettings" label="Promote Your Network" rendered="#{OptionsPage.twitterConfigured}">
                                <table class="dvnOptionsTable" cellspacing="0" cellpadding="0" border="0">
                                        <tr>
                                            <td class="dvnOptionsTableOption">
                                                <ice:outputText value="Sync Twitter"/>
                                            </td>
                                            <td>
                                                <ice:commandLink action="#{OptionsPage.authorizeTwitter}" rendered="#{!OptionsPage.twitterEnabled and !VDCRequest.readOnlyDatabase}">
                                                     <ice:outputText value="Enable Twitter"/>
                                                </ice:commandLink>
                                                <ice:commandLink action="#{OptionsPage.removeTwitter}" rendered="#{OptionsPage.twitterEnabled and !VDCRequest.readOnlyDatabase}">
                                                     <ice:outputText value="Disable Twitter"/>
                                                </ice:commandLink>
                                                <ice:outputText value=" syncing with your Dataverse to send automatic tweets."/>
                                            </td>
                                        </tr>
                                </table>
                            </ice:panelTab>
                        </ice:panelTabSet>

                      </ice:panelTab>
                      <ice:panelTab id="subnetworkOptions" onclick="initSubnetworks();" label="Subnetworks" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=subnetworks" rendered="#{VDCSession.loginBean.networkAdmin}">
                            
                          <ice:panelTab id="manageSubnetworksSub" label="Subnetworks">
                                <div jsfc="ice:panelGroup">
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/networkAdmin/ManageSubnetworksPage.xhtml"></ui:include>
                                    </div> 
                                </div>
                            </ice:panelTab>
          
                      </ice:panelTab>
                      <ice:panelTab id="collections" label="Classifications" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=classifications" rendered="#{VDCSession.loginBean.networkAdmin}">

                            <ice:panelTab id="manageClassifications" label="Manage Classifications">
                                <div jsfc="ice:panelGroup">
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/networkAdmin/ManageClassificationsPage.xhtml"></ui:include>
                                    </div> 
                                </div>
                            </ice:panelTab>

                      </ice:panelTab> 

                      <ice:panelTab id="templates" label="Templates" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=templates" 
                                    onclick="initTemplates();"
                                    rendered="#{VDCSession.loginBean.networkAdmin}">

                            <ice:panelTab id="manageTemplates" label="Manage Templates">
                                <div jsfc="ice:panelGroup">
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/admin/ManageTemplatesPage.xhtml"></ui:include>
                                    </div> 
                                </div>
                            </ice:panelTab>

                      </ice:panelTab>

                    <ice:panelTab id="controlledVocab" label="Vocabulary" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=vocabulary" 
                                  onclick="initControlledVocabulary();"
                                    rendered="#{VDCSession.loginBean.networkAdmin}">

                            <ice:panelTab id="manageControlledVocabulary" label="Manage Controlled Vocabulary">
                                <div jsfc="ice:panelGroup">
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/admin/ManageControlledVocabularyPage.xhtml"></ui:include>
                                    </div> 
                                </div>
                            </ice:panelTab>

                      </ice:panelTab>

                     <ice:panelTab id="harvestOptions" label="Harvesting" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=harvestOptions" 
                                  rendered="#{VDCSession.loginBean.networkAdmin}">
                        <ice:panelTabSet id="tabSetHarvest" styleClass="dvnTabs dvnSubTabs" binding="#{OptionsPage.harvestingSubTab}">
                            <ice:panelTab id="manageHarvestSites" label="Harvesting Dataverses">
                                <div jsfc="ice:panelGroup">
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/site/HarvestSitesPage.xhtml"></ui:include>
                                    </div>
                                </div>
                            </ice:panelTab>
                            <ice:panelTab id="manageOAIHarvestingSets" label="OAI Harvesting Sets">
                                <div jsfc="ice:panelGroup">
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/networkAdmin/OAISetsPage.xhtml"></ui:include>
                                    </div>
                                </div>
                            </ice:panelTab>
                            <ice:panelTab id="editExportSchedule" label="Settings">
                                <div jsfc="ice:panelGroup">
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/networkAdmin/EditExportSchedulePage.xhtml"></ui:include>
                                    </div> 
                                    <div jsfc="ice:panelGroup" panelLayout="flow">
                                        <ui:include src="/admin/EditLockssConfigPage.xhtml"></ui:include>
                                    </div> 
                                    <div class="dvnFormPadding dvnFormMargin">
                                          <ice:commandButton id="button1Net" value="Save Changes" action="#{OptionsPage.locksSS_save}"/>
                                    </div>
                                </div>
                            </ice:panelTab>
                        </ice:panelTabSet>
                     </ice:panelTab>

                     <ice:panelTab id="permissions" label="Permissions" onclick="initPrivilegedUserData();"
                                   url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=permissions" rendered="#{VDCSession.loginBean.networkAdmin or VDCSession.loginBean.curatorOrAbove or (not VDCRequest.currentVDC.harvestingDv and (VDCSession.loginBean.contributor or VDCRequest.currentVDC.allowRegisteredUsersToContribute))}">
                            <div jsfc="ice:panelGroup" id="layoutPanelGroupPermissions" panelLayout="flow">
                                <ice:panelTabSet id="tabSetPermissions" styleClass="dvnTabs dvnSubTabs" binding="#{OptionsPage.permissionsSubTab}">
                                    <!-- PERMISSIONS -->
                                    <ice:panelTab id="permissionsSub" label="Permissions"   onclick="initPrivilegedUserData();" immediate="true">
                                            <div jsfc="ice:panelGroup" panelLayout="flow" >
                                                <ui:include src="/networkAdmin/NetworkPrivilegedUsersPage.xhtml"  ></ui:include>
                                            </div>  
                                    </ice:panelTab>
                                    <ice:panelTab id="usersSub" label="Users" onclick="initUserData();">
                                            <div jsfc="ice:panelGroup" panelLayout="flow">
                                                <ui:include src="/networkAdmin/AllUsersPage.xhtml"></ui:include>
                                            </div>
                                    </ice:panelTab>
                                    <ice:panelTab id="groupsSub" label="Groups">
                                            <div jsfc="ice:panelGroup" panelLayout="flow">
                                                <ui:include src="/networkAdmin/UserGroupsPage.xhtml"></ui:include>
                                            </div>
                                    </ice:panelTab>
                                    <!-- TERMS -->
                                    <ice:panelTab id="termsSub" label="Terms">
                                        <table class="dvnOptionsTable" cellspacing="0" cellpadding="0" border="0">
                                            <ui:include src="/networkAdmin/EditAccountUseTermsPage.xhtml"></ui:include>
                                            <ui:include src="/networkAdmin/EditNetworkDepositUseTermsPage.xhtml"></ui:include>
                                            <ui:include src="/networkAdmin/EditNetworkDownloadUseTermsPage.xhtml"></ui:include>
                                        </table>
                                        <div jsfc="ice:panelGroup">
                                            <div class="dvnFormPadding dvnFormMargin">
                                                <ice:commandButton  styleClass="dvnListenSave" value="Save Changes"
                                                                    rendered="#{!VDCRequest.readOnlyDatabase}" action="#{OptionsPage.save_NetworkTermsOfUseAction}"/>
                                                <!--<ice:commandButton  value="Cancel" action="#{OptionsPage.toucancel_action}"/>-->
                                            </div>
                                        </div>
                                    </ice:panelTab>
                                    <ice:panelTab id="downloadDataSub" label="Download Tracking Data" onclick="initGuestBookResponses();">
                                        <div jsfc="ice:panelGroup">
                                            <div jsfc="ice:panelGroup" panelLayout="flow">
                                                <ui:include src="/admin/GuestBookResponseDataPage.xhtml"></ui:include>
                                            </div> 
                                        </div>
                                    </ice:panelTab>
                                </ice:panelTabSet>
                            </div>
                        </ice:panelTab>
                        <ice:panelTab id="utilties" label="Utilities" url="/dvn#{VDCRequest.currentVDCURL}/faces/networkAdmin/NetworkOptionsPage.xhtml?tab=utilities" rendered="#{VDCSession.loginBean.networkAdmin}">
                                <div jsfc="ice:panelGroup" id="layoutPanelGroupUtilities" panelLayout="flow">
                                    <ice:panelTabSet id="tabSetUtilities" styleClass="dvnTabs dvnSubTabs">
                                        <ice:panelTab id="studyLockOptions" label="Study">
                                            <ice:panelGrid styleClass="dvnOptionsTable" columns="2" cellpadding="0" cellspacing="0" columnClasses="dvnOptionsTableOption,dvnOptionsTableForm">
                                                <ice:column>
                                                    <ice:outputText value="Create Study Drafts"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:messages id="studyMessage" styleClass="errorMessage"/>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Input the study ID's to create Draft versions of studies. Note: If the study already has a Draft (or In Review) version, that study will be ignored."/>
                                                    <div>
                                                        <ice:inputTextarea value="#{OptionsPage.createStudyDraftIds}" rows="8" cols="80"/>
                                                        <div class="dvnFormPadding">
                                                            <ice:commandButton value="Create Study Drafts" action="#{OptionsPage.createStudyDrafts_action}"/>
                                                        </div>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Study Locks"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:messages id="studyLockMessage" styleClass="errorMessage"/>
                                                    <ice:outputText value="Current Locks:"/>
                                                    <ice:dataTable value="#{OptionsPage.studyLockList}" var="studyLock" width="100%">
                                                        <ice:column>
                                                            <f:facet name="header">
                                                                <ice:outputText value="Study ID"/>
                                                            </f:facet>
                                                            <ice:outputText value="#{studyLock.study.id}"/>
                                                        </ice:column>
                                                        <ice:column>
                                                            <f:facet name="header">
                                                                <ice:outputText value="User Name"/>
                                                            </f:facet>
                                                            <ice:outputText value="#{studyLock.user.userName}"/>
                                                        </ice:column>
                                                        <ice:column>
                                                            <f:facet name="header">
                                                                <ice:outputText value="Start Time"/>
                                                            </f:facet>
                                                            <ice:outputText value="#{studyLock.startTime}"/>
                                                        </ice:column>
                                                        <ice:column>
                                                            <f:facet name="header">
                                                                <ice:outputText value="Detail"/>
                                                            </f:facet>
                                                            <ice:outputText value="#{studyLock.detail}"/>
                                                        </ice:column>
                                                    </ice:dataTable>
                                                    <div class="dvn_padTop">
                                                        <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                        <ice:outputText value=" Input the study ID to remove a study lock."/>
                                                    </div>
                                                    <div>
                                                        <ice:inputText value="#{OptionsPage.studyLockStudyId}" size="6"/>
                                                        <ice:commandButton value="Remove Lock" action="#{OptionsPage.removeLock_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Delete Studies"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:messages id="deleteMessage" styleClass="errorMessage"/>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Input the study ID's to delete arbitrary studies."/>
                                                    <div>
                                                        <ice:inputTextarea value="#{OptionsPage.deleteStudyIds}" rows="8" cols="80"/>
                                                        <div class="dvnFormPadding">
                                                            <ice:commandButton value="Delete Studies" action="#{OptionsPage.deleteStudies_action}"
                                                                            onclick="if(!confirm('Please confirm this DELETE request. This change CANNOT be undone.')){ return false; };"/>
                                                        </div>
                                                    </div>
                                                </ice:column>
                                            </ice:panelGrid>
                                        </ice:panelTab>   
                                        <ice:panelTab id="indexUtilties" label="Index">
                                            <ice:panelGrid styleClass="dvnOptionsTable" columns="2" cellpadding="0" cellspacing="0" columnClasses="dvnOptionsTableOption,dvnOptionsTableForm">
                                                <ice:column>
                                                    <ice:outputText value="Reindex All Studies"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:messages id="indexMessage" styleClass="errorMessage"/>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Reindex all studies. Note: the index directory must be empty before 'Index All' can be run."/>
                                                    <div>
                                                        <ice:commandButton value="Index All" action="#{OptionsPage.indexAll_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Reindex Dataverse"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Input the Dataverse ID to index studies owned by a specific Dataverse."/>
                                                    <div>
                                                        <ice:inputText value="#{OptionsPage.indexDVId}" size="6"/>
                                                        <ice:commandButton value="Index Dataverse" action="#{OptionsPage.indexDV_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Reindex Individual Studies"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Input the study ID's to index arbitrary studies."/>
                                                    <div>
                                                        <ice:inputTextarea value="#{OptionsPage.indexStudyIds}" rows="8" cols="80"/>
                                                        <div class="dvnFormPadding">
                                                            <ice:commandButton value="Index Studies" action="#{OptionsPage.indexStudies_action}"/>
                                                        </div>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Index Unindexed Studies"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Index unindexed studies."/>
                                                    <div>
                                                        <ice:commandButton value="Index Update" action="#{OptionsPage.indexBatch_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Delete Index Lock"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="#{OptionsPage.indexLocks}"/>
                                                    <div class="dvnFormPadding">
                                                        <ice:commandButton value="Delete Lock" action="#{OptionsPage.indexLocks_action}" disabled="#{OptionsPage.deleteLockDisabled}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Reindex All Collection-linked Studies"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Reindex all studies linked to dataverses via collections"/>
                                                    <div>
                                                        <ice:commandButton value="Index Collections" action="#{OptionsPage.indexCollectionStudies_action}"/>
                                                    </div>
                                                </ice:column>
                                            </ice:panelGrid>
                                        </ice:panelTab>
                                        <ice:panelTab id="exportOptions" label="Export">
                                            <ice:panelGrid styleClass="dvnOptionsTable" columns="2" cellpadding="0" cellspacing="0" columnClasses="dvnOptionsTableOption,dvnOptionsTableForm">
                                                <ice:column>
                                                    <ice:outputText value="Run Export"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:messages id="exportMessage" styleClass="errorMessage"/>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Run the export and all updated studies in all formats will be exported and update harvest studies will be run."/>
                                                    <div>
                                                        <ice:commandButton value="Run Export" action="#{OptionsPage.exportUpdated_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Update Harvest Studies"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Update harvest studies."/>
                                                    <div>
                                                        <ice:commandButton value="Update Harvest Studies" action="#{OptionsPage.updateHarvestStudies_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Custom Export"/>
                                                </ice:column>
                                                <ice:column>
                                                    <div>
                                                        <ice:outputText value="OR, for a CUSTOM export (note: harvest studies will NOT be updated), select export format, then either:"/>
                                                        <ice:selectOneMenu id="dropdown1" value="#{OptionsPage.exportFormat}">
                                                            <f:selectItem itemLabel="Export all formats" itemValue=""/>
                                                            <f:selectItem itemLabel="- Export DDI only" itemValue="ddi"/>
                                                            <f:selectItem itemLabel="- Export Dublin Core only" itemValue="oai_dc"/>
                                                            <f:selectItem itemLabel="- Export Marc only" itemValue="marc"/>
                                                        </ice:selectOneMenu>
                                                    </div>
                                                    <div class="dvnFormPadding">
                                                        <ice:outputText value="a) Export all studies (regardless of update time)."/>
                                                        <div>
                                                            <ice:commandButton  value="Export All" action="#{OptionsPage.exportAll_action}"/>
                                                        </div>
                                                    </div>
                                                    <div class="dvnFormPadding">
                                                        <ice:outputText value="b) Input the Dataverse ID to export studies owned by a specific Dataverse (regardless of update time)."/>
                                                        <div>
                                                            <ice:inputText value="#{OptionsPage.exportDVId}" size="6"/>
                                                            <ice:commandButton value="Export Dataverse" action="#{OptionsPage.exportDV_action}"/>
                                                        </div>
                                                    </div>
                                                    <div class="dvnFormPadding">
                                                        <ice:outputText value="c) Input the study ID's to export arbitrary studies (regardless of update time)."/>
                                                        <div>
                                                            <ice:inputTextarea value="#{OptionsPage.exportStudyIds}" rows="8" cols="80"/>
                                                            <div class="dvnFormPadding">
                                                                <ice:commandButton value="Export Studies" action="#{OptionsPage.exportStudies_action}"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </ice:column>
                                            </ice:panelGrid>
                                        </ice:panelTab> 
                                        <ice:panelTab id="harvestOptions" label="Harvest">
                                            <ice:panelGrid styleClass="dvnOptionsTable" columns="2" cellpadding="0" cellspacing="0" columnClasses="dvnOptionsTableOption,dvnOptionsTableForm">
                                                <ice:column>
                                                    <ice:outputText value="Harvest Specific Study"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:messages id="harvestMessage"  styleClass="errorMessage"/>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Input the Dataverse and the harvest identifier to harvest a specific study."/>
                                                    <div jsfc="ice:panelGroup">
                                                        <ice:selectOneMenu value="#{OptionsPage.harvestDVId}">
                                                            <f:selectItems value="#{OptionsPage.harvestDVs}"/>
                                                        </ice:selectOneMenu>
                                                        <ice:inputText value="#{OptionsPage.harvestIdentifier}" size="60"/>
                                                        <ice:commandButton value="Harvest Study" action="#{OptionsPage.harvestStudy_action}"/>
                                                    </div>
                                                </ice:column>
                                            </ice:panelGrid>
                                        </ice:panelTab> 
                                        <ice:panelTab id="fileOptions" label="File">
                                            <ice:panelGrid styleClass="dvnOptionsTable" columns="2" cellpadding="0" cellspacing="0" columnClasses="dvnOptionsTableOption,dvnOptionsTableForm">
                                                <ice:column>
                                                    <ice:outputText value="Extension File Types"/>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:messages id="fileMessage" styleClass="errorMessage"/>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Determine the file types for files with a particular extension."/>
                                                    <div jsfc="ice:panelGroup">
                                                        <ice:inputText value="#{OptionsPage.fileExtension}" size="6"/>
                                                        <ice:commandButton value="Determine Extension File Types" action="#{OptionsPage.determineFileTypeForExtension_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Study File Types"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Input the study ID's to determine the file types for files in arbitrary studies."/>
                                                    <div>
                                                        <ice:inputTextarea value="#{OptionsPage.fileStudyIds}" rows="8" cols="80"/>
                                                        <div class="dvnFormPadding">
                                                            <ice:commandButton value="Determine Study File Types" action="#{OptionsPage.determineFileTypeForStudies_action}"/>
                                                        </div>
                                                    </div>
                                                </ice:column>
                                            </ice:panelGrid>
                                        </ice:panelTab> 
                                         <ice:panelTab id="importOptions" label="Import">
                                            <ice:panelGrid styleClass="dvnOptionsTable" columns="2" cellpadding="0" cellspacing="0" columnClasses="dvnOptionsTableOption,dvnOptionsTableForm">
                                                <ice:column>
                                                    <ice:outputText value="Import Files"/>
                                                </ice:column>
                                                <ice:column>
                                                    <div>
                                                        <ice:messages id="importMessage" styleClass="errorMessage"/>
                                                        <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                        <ice:outputText value=" Select the file format and the dataverse for the import, then either:"/>
                                                        <div>
                                                            <ice:selectOneMenu value="#{OptionsPage.importFileFormat}">
                                                                <f:selectItems value="#{OptionsPage.importFileFormatTypes}"/>
                                                            </ice:selectOneMenu>
                                                            <ice:selectOneMenu value="#{OptionsPage.importDVId}">
                                                                <f:selectItems value="#{OptionsPage.importDVs}"/>
                                                            </ice:selectOneMenu>
                                                        </div>
                                                    </div>
                                                    <div class="dvnFormPadding">
                                                        <ice:outputText value="a) Batch import - input directory."/>
                                                        <div>
                                                            <ice:inputText value="#{OptionsPage.importBatchDir}" size="80"/>
                                                            <ice:commandButton value="Batch Import" action="#{OptionsPage.importBatch_action}"/>
                                                        </div>
                                                    </div>
                                                    <div class="dvnFormPadding">
                                                        <ice:outputText value="or b) Single import - browse for the file."/>
                                                        <div>
                                                            <!-- Commenting out the InputFile section: - L.A.
                                                            <ice:inputFile id="inputImportFileComponent" label="Upload"
                                                                            action="#{UtilitiesPage.uploadFile}" binding="#{UtilitiesPage.inputFile}"
                                                                            progressListener="#{UtilitiesPage.fileUploadProgress}"
                                                                            accept="#{UtilitiesPage.importDVId}, #{UtilitiesPage.importFileFormat}">
                                                            </ice:inputFile>
                                                            L.A. -->
                                                            <ace:fileEntry id="inputImportFileComponent"
                                                                relativePath="/temp/" 
                                                                maxFileCount="1" 
                                                                maxFileCountMessage="Limited to 1 file upload only (for now)" 
                                                                fileEntryListener="#{OptionsPage.uploadFileListener}" 
                                                                maxFileSize="2147483648" 
                                                                maxFileSizeMessage="Submitted file is too large." 
                                                                maxTotalSize="2147483648" 
                                                                maxTotalSizeMessage="Total size of submitted files is too large." 
                                                                useOriginalFilename="true" 
                                                                useSessionSubdir="false"/>
                                                            <span class="top">
                                                                <h:commandButton styleClass="submit" type="submit" value="Upload File"/>
                                                            </span>
                                                            <div class="dvnFormPadding">
                                                                <ice:commandButton value="Single Import" id="buttonEV"
                                                                                action="#{OptionsPage.importSingleFile_action}"/>
                                                            </div>
                                                            <ice:message for="inputImportFileComponent"/>
                                                            <!-- Progress display for the old-style import:
                                                            <ice:outputProgress
                                                                value="#{UtilitiesPage.fileProgress}">
                                                            </ice:outputProgress>
                                                            L.A. -->
                                                        </div>
                                                    </div>
                                                </ice:column>
                                            </ice:panelGrid>
                                        </ice:panelTab>
                                        <ice:panelTab id="handleOptions" label="Handle">
                                            <ice:panelGrid styleClass="dvnOptionsTable" columns="2" cellpadding="0" cellspacing="0" columnClasses="dvnOptionsTableOption,dvnOptionsTableForm">
                                                <ice:column>
                                                    <ice:outputText value="Register"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Register all unregistered handles."/>
                                                    <ice:messages id="handleMessage" styleClass="errorMessage"/>
                                                    <div>
                                                        <ice:commandButton value="Register All" action="#{OptionsPage.handleRegisterAll_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Fix"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Re-register all registered handles."/>
                                                    <div>
                                                        <ice:commandButton value="Fix Handles" action="#{OptionsPage.handleFixAll_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Re-register"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Enter the global ID to re-register a single handle."/>
                                                    <div>
                                                        <ice:inputText value="#{OptionsPage.fixGlobalId}" size="6"/>
                                                        <ice:commandButton value="Fix Handle" action="#{OptionsPage.handleFixSingle_action}"/>
                                                    </div>
                                                </ice:column>
                                                <ice:column>
                                                    <ice:outputText value="Status Check"/>
                                                </ice:column>
                                                <ice:column>
                                                    <img class="dvn_icon" src="/dvn/resources/images/icon_information.18.png" alt=""/>
                                                    <ice:outputText value=" Enter the database ID's of a range of studies to check the handle registration status."/>
                                                    <div>
                                                        <ice:inputText value="#{OptionsPage.studyIdRange}" size="12"/>
                                                        <ice:commandButton value="Check Handles" action="#{OptionsPage.handleCheckRange_action}"/>
                                                        <ice:inputTextarea value="#{OptionsPage.handleCheckReport}" rows="8" cols="32" readonly="true" rendered="#{! empty OptionsPage.handleCheckReport}"/>
                                                    </div>
                                                </ice:column>
                                            </ice:panelGrid>
                                        </ice:panelTab>
                                    </ice:panelTabSet>
                                </div>                  
                        </ice:panelTab>
                    </ice:panelTabSet>
                </div>
            
                <ice:panelPopup id="defaultPopup"
                                draggable="false"
                                visible="#{OptionsPage.showDefaultPopup}"
                                autoCentre="true"
                                modal="true">
                    <f:facet name="header">
                        <ice:panelGrid id="autoCentDefaultPanelGrid"
                                        width="100%" cellpadding="0"
                                        cellspacing="0" columns="2"
                                        columnClasses="none,popupButton">
                            <ice:outputText value="Select Network/Subnetwork"/>
                            <ice:commandLink id="autoCentMigrationPopupClose"
                                                action="#{OptionsPage.toggleDefaultPopup(0)}"
                                                styleClass="popupModalClose">
                                <ice:graphicImage value="/resources/images/icon_close.gif"/>
                            </ice:commandLink>
                        </ice:panelGrid>
                    </f:facet>
                    <f:facet name="body">
                        <ice:panelGrid id="autoCentDefault"
                                        width="100%" cellpadding="0"
                                        cellspacing="0" columns="1"
                                        styleClass="popupModalBody">
                            <ice:outputText value="Select the Dataverse Network, or Subnetwork(s), that you wish to make this template the default study template."/>
                            <div jsfc="ice:panelGroup">
                                <ice:dataTable width="100%" cellspacing="0" cellpadding="0" styleClass="dvnSelectTemplateDefaultNetwork"
                                                id="vdcSubnetworks" var="vdcNetworkUI" value="#{OptionsPage.vdcNetworksForDefault}"
                                                scrollable="true" scrollHeight="200px" columnWidths="11%,89%">
                                    <ice:column>
                                        <ice:selectBooleanCheckbox id="genericCheckBoxes" styleClass="templateCheckBoxes" rendered="#{!vdcNetworkUI.defaultTemplateSelected}"
                                                                    partialSubmit="false" value="#{vdcNetworkUI.defaultTemplateSelected}"/>
                                    </ice:column>
                                    <ice:column>
                                        <ice:outputText value="#{vdcNetworkUI.vdcNetwork.name} #{vdcNetworkUI.vdcNetwork.id == VDCRequest.vdcNetwork.id ? 'Dataverse Network' : 'Subnetwork'}"/>
                                        <ice:outputText styleClass="dvnSelectedTemplateDefault" value=" Default" rendered="#{vdcNetworkUI.defaultTemplateSelected}"/>
                                    </ice:column>
                                </ice:dataTable>
                            </div>
                            <div jsfc="ice:panelGroup" styleClass="dvnFormPadding dvnFormMargin">
                                <ice:commandButton id="autoCentDefaultTemplatePopupCancel" 
                                                    action="#{OptionsPage.saveDefaultTemplates}"
                                                    value="Save"/>
                                <ice:commandButton id="autoCentDefaultTemplatePopupExit"
                                                    action="#{OptionsPage.toggleDefaultPopup(0)}"
                                                    value="Cancel"/>
                            </div>
                        </ice:panelGrid>
                    </f:facet>
                </ice:panelPopup>
            </ice:form>
        </ui:define>
    </ui:composition>
</body>
</html>
